<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="20081" />

<meta name="date" content="2020-12-10" />

<title>Homework Vignette</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework Vignette</h1>
<h4 class="author">20081</h4>
<h4 class="date">2020-12-10</h4>



<div id="homework-0" class="section level1">
<h1>Homework 0</h1>
<div id="question" class="section level2">
<h2>Question</h2>
<p>The Fisher <code>iris</code> dataset gives four measurements on observations from three species of iris, whose names are setosa, versicolor and virginica. We will produce three examples based on <code>iris</code> dataset. The first one contains a combinatorial plot describing the distribution of the two features, sepal length and sepal width. The second example shows a table summarizing <code>iris</code> dataset. The third example illustrates a machine learning algorithm for species classification, including the theory and classification result.</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<div id="example-1" class="section level3">
<h3>Example 1</h3>
<p>The combinatorial plot contains two univariate histograms, describing the distribution of variable sepal length and sepal width. The scatterplot is a bivariate plot. From the scatterplot, it seems that we can seperate these three flowers according to features sepal width and sepal length. This will be demonstrated in <code>Example 3</code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(grid)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="co"># Show bivariate scatter plot and univariate histogram</span></span>
<span id="cb1-4"><a href="#cb1-4"></a>p.scatter &lt;-<span class="st"> </span><span class="kw">ggplot</span>(iris) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x=</span>Sepal.Length, <span class="dt">y=</span>Sepal.Width, <span class="dt">color=</span>Species))</span>
<span id="cb1-5"><a href="#cb1-5"></a>p.hist.len &lt;-<span class="st"> </span><span class="kw">ggplot</span>(iris) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">x=</span>Sepal.Length))</span>
<span id="cb1-6"><a href="#cb1-6"></a>p.hist.wid &lt;-<span class="st"> </span><span class="kw">ggplot</span>(iris) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">x=</span>Sepal.Width)) <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>()</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="kw">grid.newpage</span>()</span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="kw">pushViewport</span>(<span class="kw">viewport</span>(<span class="dt">layout =</span> <span class="kw">grid.layout</span>(<span class="dv">3</span>, <span class="dv">3</span>)))</span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="kw">print</span>(p.scatter, <span class="dt">vp=</span><span class="kw">viewport</span>(<span class="dt">layout.pos.row=</span><span class="dv">2</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">layout.pos.col=</span><span class="dv">1</span><span class="op">:</span><span class="dv">2</span>))</span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="kw">print</span>(p.hist.len, <span class="dt">vp=</span><span class="kw">viewport</span>(<span class="dt">layout.pos.row=</span><span class="dv">1</span>, <span class="dt">layout.pos.col=</span><span class="dv">1</span><span class="op">:</span><span class="dv">2</span>))</span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="kw">print</span>(p.hist.wid, <span class="dt">vp=</span><span class="kw">viewport</span>(<span class="dt">layout.pos.row=</span><span class="dv">2</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">layout.pos.col=</span><span class="dv">3</span>))</span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="example-2" class="section level3">
<h3>Example 2</h3>
<p>This table shows the first five rows of <code>iris</code> dataset.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">head</span>(iris, <span class="dt">n=</span><span class="dv">5</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">Sepal.Length</th>
<th align="right">Sepal.Width</th>
<th align="right">Petal.Length</th>
<th align="right">Petal.Width</th>
<th align="left">Species</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">5.1</td>
<td align="right">3.5</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">4.9</td>
<td align="right">3.0</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">4.7</td>
<td align="right">3.2</td>
<td align="right">1.3</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">4.6</td>
<td align="right">3.1</td>
<td align="right">1.5</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">5.0</td>
<td align="right">3.6</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">The following t</td>
<td align="right">able gives a s</td>
<td align="right">ummary of `iris</td>
<td align="right">` dataset.</td>
<td align="left"></td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">summary</span>(iris))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="center">Sepal.Length</th>
<th align="center">Sepal.Width</th>
<th align="center">Petal.Length</th>
<th align="center">Petal.Width</th>
<th align="center">Species</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td align="center">Min. :4.300</td>
<td align="center">Min. :2.000</td>
<td align="center">Min. :1.000</td>
<td align="center">Min. :0.100</td>
<td align="center">setosa :50</td>
</tr>
<tr class="even">
<td></td>
<td align="center">1st Qu.:5.100</td>
<td align="center">1st Qu.:2.800</td>
<td align="center">1st Qu.:1.600</td>
<td align="center">1st Qu.:0.300</td>
<td align="center">versicolor:50</td>
</tr>
<tr class="odd">
<td></td>
<td align="center">Median :5.800</td>
<td align="center">Median :3.000</td>
<td align="center">Median :4.350</td>
<td align="center">Median :1.300</td>
<td align="center">virginica :50</td>
</tr>
<tr class="even">
<td></td>
<td align="center">Mean :5.843</td>
<td align="center">Mean :3.057</td>
<td align="center">Mean :3.758</td>
<td align="center">Mean :1.199</td>
<td align="center">NA</td>
</tr>
<tr class="odd">
<td></td>
<td align="center">3rd Qu.:6.400</td>
<td align="center">3rd Qu.:3.300</td>
<td align="center">3rd Qu.:5.100</td>
<td align="center">3rd Qu.:1.800</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td></td>
<td align="center">Max. :7.900</td>
<td align="center">Max. :4.400</td>
<td align="center">Max. :6.900</td>
<td align="center">Max. :2.500</td>
<td align="center">NA</td>
</tr>
</tbody>
</table>
</div>
<div id="example-3" class="section level3">
<h3>Example 3</h3>
<p>Here we illustrate the theory of Naive Bayes[1]: Suppose that we wish to classify an observation into one of <span class="math inline">\(K\)</span> classes, where <span class="math inline">\(K \geq 2\)</span>. In other words, the qualitative response variable <span class="math inline">\(Y\)</span> can take on <span class="math inline">\(K\)</span> possible distinct and unordered values. Let <span class="math inline">\(\pi_k\)</span> represent the overall or prior prior probability that a randomly chosen observation comes from the <span class="math inline">\(k\)</span>th class; this is the probability that a given observation is associated with the <span class="math inline">\(k\)</span>th category of the response variable <span class="math inline">\(Y\)</span> . Let <span class="math inline">\(f_k(x) \equiv \text{Pr}(X=x | Y=k)\)</span> denote the density function of <span class="math inline">\(X\)</span> for an observation that comes from the <span class="math inline">\(k\)</span>th class. In other words, <span class="math inline">\(f_k(x)\)</span> is relatively large if there is a high probability that function an observation in the kth class has <span class="math inline">\(X \approx x\)</span>, and <span class="math inline">\(f_k(x)\)</span> is small if it is very unlikely that an observation in the <span class="math inline">\(k\)</span>th class has <span class="math inline">\(X \approx x\)</span>. Then Bayes’ theorem states that <span class="math display">\[\text{Pr}(Y=k | X=x) = \frac{\pi_k f_k(x)}{ \sum_{l=1}^{K} \pi_l f_l(x)}.\]</span></p>
<p>We will use Naive Bayes algorithm on <code>iris</code> dataset. The accuracy evaluation will be based on five-fold cross validation. The overall accuracy score is calculated by <span class="math display">\[\text{accuracy} = \frac{1}{5} \sum_{k=1}^{5} \text{accuracy}_{k}^{CV}.\]</span></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="kw">library</span>(caret)  <span class="co">#`library(caret)` for cross validation </span></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="co">#&gt; 载入需要的程辑包：lattice</span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="kw">library</span>(e1071)  <span class="co"># `library(e1071)` for Naive Bayes</span></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="kw">set.seed</span>(<span class="dv">922</span>)</span>
<span id="cb4-6"><a href="#cb4-6"></a>trainIndex &lt;-<span class="st"> </span><span class="kw">createDataPartition</span>(iris<span class="op">$</span>Species,<span class="dt">p=</span><span class="fl">0.8</span>,<span class="dt">list=</span>F,<span class="dt">times=</span><span class="dv">5</span>)</span>
<span id="cb4-7"><a href="#cb4-7"></a></span>
<span id="cb4-8"><a href="#cb4-8"></a></span>
<span id="cb4-9"><a href="#cb4-9"></a>accuracy &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">5</span>)<span class="co"># A numeric vector for restoring validated accuracy</span></span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="cf">for</span> (fold <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>){</span>
<span id="cb4-11"><a href="#cb4-11"></a>  train.idx &lt;-<span class="st"> </span>trainIndex[,fold]</span>
<span id="cb4-12"><a href="#cb4-12"></a>  nb &lt;-<span class="st"> </span><span class="kw">naiveBayes</span>(Species <span class="op">~</span>., <span class="dt">data=</span>iris)</span>
<span id="cb4-13"><a href="#cb4-13"></a>  pred &lt;-<span class="st"> </span><span class="kw">predict</span>(nb, iris[<span class="op">-</span>train.idx, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>], <span class="dt">type=</span><span class="st">&quot;class&quot;</span>)  <span class="co"># prediction on validation dataset</span></span>
<span id="cb4-14"><a href="#cb4-14"></a>  accuracy[fold] &lt;-<span class="st"> </span><span class="kw">confusionMatrix</span>(iris[<span class="op">-</span>train.idx, <span class="dv">5</span>], pred)[[<span class="st">&quot;overall&quot;</span>]][<span class="dv">1</span>]</span>
<span id="cb4-15"><a href="#cb4-15"></a>}</span>
<span id="cb4-16"><a href="#cb4-16"></a></span>
<span id="cb4-17"><a href="#cb4-17"></a><span class="kw">cat</span>(<span class="st">&quot;The mean accuracy of five-fold cross validation is&quot;</span>, <span class="kw">mean</span>(accuracy))</span>
<span id="cb4-18"><a href="#cb4-18"></a><span class="co">#&gt; The mean accuracy of five-fold cross validation is 0.9866667</span></span></code></pre></div>
</div>
</div>
<div id="reference" class="section level2">
<h2>Reference</h2>
<p>[1] James G , Witten D , Hastie T , et al. An Introduction to Statistical Learning[M]. Springer New York, 2013.</p>
</div>
</div>
<div id="homework-1" class="section level1">
<h1>Homework 1</h1>
<div id="section" class="section level2">
<h2>3.3</h2>
<p>The Pareto(a, b) distribution has cdf <span class="math display">\[F(x) = 1-(\frac{b}{x})^a, x\geq b&gt;0, a&gt;0.\]</span> Derive the probability inverse transformation <span class="math inline">\(F^{-1}(U)\)</span> and use the inverse transform method to simulate a random sample from the Pareto(2, 2) distribution. Graph the density histogram of the sample with the Pareto(2, 2) density superimposed for comparison.</p>
<p><span class="math inline">\(\textbf{Solution:}\)</span></p>
<p>Let <span class="math inline">\(y=1-(\frac{b}{x})^a\)</span>, and express <span class="math inline">\(x\)</span> as a function of <span class="math inline">\(y\)</span>, <span class="math display">\[(\frac{b}{x})^a=1-y\]</span> <span class="math display">\[\begin{aligned}
 &amp; \Leftrightarrow \log(\frac{b}{x}) = \frac{1}{a} \log(1-y) \\
 &amp; \Leftrightarrow x = \exp\left\{ \log b - \frac{\log(1-y)}{a}\right\} \\
 &amp; \Leftrightarrow x=\frac{b}{\exp\left( \frac{\log(1-y)}{a}\right)} \\
 &amp; \Leftrightarrow x = b(1-y)^{-1/a}.
\end{aligned}\]</span></p>
<p>Then <span class="math inline">\(F^{-1}(U)=b(1-U)^{-1/a}.\)</span></p>
<p>The probability density function is <span class="math inline">\(f(x)=F&#39;(x)=ab^ax^{-(a+1)}.\)</span></p>
<p><span class="math inline">\(\textbf{Code:}\)</span></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>generate.pareto &lt;-<span class="st"> </span><span class="cf">function</span>(n, a, b){</span>
<span id="cb5-2"><a href="#cb5-2"></a>  U &lt;-<span class="st"> </span><span class="kw">runif</span>(n)</span>
<span id="cb5-3"><a href="#cb5-3"></a>  P &lt;-<span class="st"> </span>b <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>U)<span class="op">^</span>(<span class="op">-</span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>a)</span>
<span id="cb5-4"><a href="#cb5-4"></a>  <span class="kw">return</span> (P)</span>
<span id="cb5-5"><a href="#cb5-5"></a>}</span>
<span id="cb5-6"><a href="#cb5-6"></a></span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="kw">set.seed</span>(<span class="dv">929</span>)</span>
<span id="cb5-8"><a href="#cb5-8"></a>a &lt;-<span class="st"> </span>b &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb5-9"><a href="#cb5-9"></a>p &lt;-<span class="st"> </span><span class="kw">generate.pareto</span>(<span class="fl">1e4</span>, a, b)</span>
<span id="cb5-10"><a href="#cb5-10"></a></span>
<span id="cb5-11"><a href="#cb5-11"></a><span class="kw">hist</span>(p, <span class="dt">prob=</span><span class="ot">TRUE</span>, <span class="dt">breaks=</span><span class="dv">50</span>, <span class="dt">main=</span><span class="st">&quot;Histogram of Pareto(2,2)&quot;</span>)</span>
<span id="cb5-12"><a href="#cb5-12"></a>y &lt;-<span class="st"> </span><span class="kw">sort</span>(p)</span>
<span id="cb5-13"><a href="#cb5-13"></a>fy &lt;-<span class="st"> </span>a <span class="op">*</span><span class="st"> </span>b<span class="op">^</span>a <span class="op">*</span><span class="st"> </span>y<span class="op">^</span>(<span class="op">-</span>(a <span class="op">+</span><span class="st"> </span><span class="dv">1</span>))</span>
<span id="cb5-14"><a href="#cb5-14"></a><span class="kw">lines</span>(y, fy, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">lty=</span><span class="dv">1</span>, <span class="dt">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The figure below shows the histogram density estimate and the true density function(in red line).</p>
</div>
<div id="section-1" class="section level2">
<h2>3.9</h2>
<p>The rescaled Epanechnikov kernel is a symmetric density function <span class="math display">\[f_e(x)=\frac{3}{4}(1-x^2), |x| \leq 1.\]</span> Devroye and Gyorfi give the following algorithm for simulation from this distribution. Generate iid <span class="math inline">\(U_1, U_2, U_3 \sim Uniform(-1, 1).\)</span> If <span class="math inline">\(|U_3| \geq |U_2|\)</span> and <span class="math inline">\(|U_3| \geq |U_1|\)</span>, deliver <span class="math inline">\(U_2\)</span>; otherwise deliver <span class="math inline">\(U_3\)</span>. Write a function to generate random variates from <span class="math inline">\(f_e\)</span>, and construct the histogram density estimate of a large simulated random sample.</p>
<p><span class="math inline">\(\textbf{Solution:}\)</span></p>
<p><span class="math inline">\(\textbf{Code:}\)</span></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>generate.fe &lt;-<span class="st"> </span><span class="cf">function</span>(n){</span>
<span id="cb6-2"><a href="#cb6-2"></a>  U1 &lt;-<span class="st"> </span><span class="kw">runif</span>(n, <span class="dv">-1</span>, <span class="dv">1</span>)</span>
<span id="cb6-3"><a href="#cb6-3"></a>  U2 &lt;-<span class="st"> </span><span class="kw">runif</span>(n, <span class="dv">-1</span>, <span class="dv">1</span>)</span>
<span id="cb6-4"><a href="#cb6-4"></a>  U3 &lt;-<span class="st"> </span><span class="kw">runif</span>(n, <span class="dv">-1</span>, <span class="dv">1</span>)</span>
<span id="cb6-5"><a href="#cb6-5"></a>  </span>
<span id="cb6-6"><a href="#cb6-6"></a>  U &lt;-<span class="st"> </span><span class="kw">ifelse</span>((<span class="kw">abs</span>(U3) <span class="op">&gt;=</span><span class="st"> </span><span class="kw">abs</span>(U2) <span class="op">&amp;</span><span class="st"> </span><span class="kw">abs</span>(U3) <span class="op">&gt;=</span><span class="st"> </span><span class="kw">abs</span>(U1)), U2, U3)</span>
<span id="cb6-7"><a href="#cb6-7"></a>  <span class="kw">return</span> (U)</span>
<span id="cb6-8"><a href="#cb6-8"></a>}</span>
<span id="cb6-9"><a href="#cb6-9"></a></span>
<span id="cb6-10"><a href="#cb6-10"></a><span class="kw">set.seed</span>(<span class="dv">929</span>)</span>
<span id="cb6-11"><a href="#cb6-11"></a>U &lt;-<span class="st"> </span><span class="kw">generate.fe</span>(<span class="fl">1e4</span>)</span>
<span id="cb6-12"><a href="#cb6-12"></a><span class="kw">hist</span>(U, <span class="dt">breaks =</span> <span class="dv">20</span>, <span class="dt">prob=</span><span class="ot">TRUE</span>, <span class="dt">main=</span><span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Histogram of &quot;</span>, f[e])))</span>
<span id="cb6-13"><a href="#cb6-13"></a><span class="kw">lines</span>(<span class="kw">density</span>(U), <span class="dt">lty=</span><span class="dv">1</span>, <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb6-14"><a href="#cb6-14"></a><span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="st">&quot;Kernel Density Estimate&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">lty=</span><span class="dv">1</span>, <span class="dt">bty=</span><span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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3hoRUHhLFuiDvDaSh969NTKgMEJhBue3kdx3kDoFoGBCgTXSI7mV9yh+EkChhJIDChhiTAOIrYIQDQTk2gOySni9by5APIhQGguql2VN/2fWkjkcG9ANiwABhQE6pThbf10K7CiiwertKQSQx1DDJDpr5QPkvc3KN1HPcJMEGxLc34LSfvnVAPIYrIYlenOA8GA1LNHbA5Q4UQKUJhwBmmOwgcHTJkqA0oS7PUC3JAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQJKDejwab3cUUbeZ2XFdyfWfqKnhB23jwzLWmJAx029HiQvlCkjCFnx3YlZT5qfBE+WtbSAymZVWq8RDb9LxorvTsx+0rNcNzRrSQGV7KHOor6IaPhdMlZ8d2L2k72z0IOzltoHNblQ1j78JhArvjsx+0nxOXP/SOOwrGUDpOv4cCdkxXcnZj3RP17luq93WNZuClAnC0mydltVTH/kuIZt0ipW/w77tE5af+Ro62fmpKdo5nXJYRWbrplv52KSjqIqNHTSE3YUTS70rYP7yKGGiY8Ss4LJn2R2XQQ5LGs0WAUiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECGjegKqfFoz7feUoESAgAgREgIAIEBABAiJAQAQIaN6Aqq2ocb+vHKWZA9KbmVu/tDy6Zg7ouFF7Vye8+XPmgLi6HHU6DzR/QJOLAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBAfwJGuXQ4LprYtQAAAABJRU5ErkJggg==" /><!-- --></p>
<p>The figure below shows the histogram density estimate and the kernel density function(in blue line).</p>
</div>
<div id="section-2" class="section level2">
<h2>3.10</h2>
<p>Prove that the algorithm given in Exercise 3.9 generates variates from the density <span class="math inline">\(f_e\)</span>.</p>
<p><span class="math inline">\(\textbf{Proof:}\)</span></p>
<p>From the fact that <span class="math inline">\(U \sim Uniform(-1,1), |U| \sim U(0,1)\)</span>, we can restate the algorithm as follows:</p>
<p>Generate iid <span class="math inline">\(V_1, V_2, V_3 \sim Uniform(0, 1)\)</span>. If <span class="math inline">\(V_3 = \max(V_1, V_2, V_3)\)</span>, then <span class="math inline">\(V=V_2\)</span>, otherwise <span class="math inline">\(V=V_3\)</span>. We can see that <span class="math inline">\(V\)</span> is either the first or the second ordered statistic of <span class="math inline">\(V_1, V_2, V_3\)</span>. Then deliver <span class="math inline">\(Y=\pm V\)</span> with probability 1/2, 1/2 finally.</p>
<p>Note that the distribution function of the <span class="math inline">\(k^{th}\)</span> ordered statistc when <span class="math inline">\(n=3\)</span> is given by <span class="math display">\[G_k(y_k) = P(V_{(k)} \leq y_k) = \sum_{j=k}^{3} C_{3}^{j} [F(y_k)]^j [1-F(y_k)]^{3-j},\]</span> where <span class="math inline">\(F(y_k)=y_k\)</span> is the cdf of <span class="math inline">\(Uniform(0,1)\)</span>.</p>
<p>The distribution function of <span class="math inline">\(V\)</span> is <span class="math display">\[
\begin{aligned}
G(v) &amp;= \frac12G_1(v) + \frac12G_2(v) \\
     &amp;= \frac12[(1-(1-v)^3) + (3v^2(1-v) + v^3)] \\
     &amp;= \frac12(3v - v^3).
\end{aligned}
\]</span></p>
<p>and the probability density function of <span class="math inline">\(v\)</span> is <span class="math display">\[
g(v) = G&#39;(v) = \frac12(3-3v^2) = \frac32 (1-v^2), v \in (0,1).
\]</span></p>
<p>Therefore, the density of <span class="math inline">\(Y\)</span> is <span class="math display">\[
f_Y(y) = \frac12 \times \frac32(1-y^2) = \frac34(1-y^2), y \in (-1,1).
\]</span></p>
</div>
<div id="section-3" class="section level2">
<h2>3.13</h2>
<p>It can be shown that the mixture in Exercise 3.12 has a Pareto distribution with cdf <span class="math display">\[F(y) = 1 - \left(\frac{\beta}{\beta + y}\right)^r, y \geq 0.\]</span> (This is an alternative parameterization of the Pareto cdf given in Exercise 3.3.) Generate 1000 random observations from the mixture with <span class="math inline">\(r = 4\)</span> and <span class="math inline">\(\beta=2\)</span>. Compare the empirical and theoretical (Pareto) distributions by graphing the density histogram of the sample and superimposing the Pareto density curve.</p>
<p><span class="math inline">\(\textbf{Solution:}\)</span></p>
<p>First, like Exercise 3.3, we can get the inverse of the distribution function <span class="math inline">\(F^{-1}(y)=\beta\left\{\frac{1}{(1-y)^{1/r}}-1\right\}.\)</span></p>
<p>The probability density function is <span class="math inline">\(f(y)=F&#39;(y)=\frac{r\beta^r}{(\beta+y)^{r+1}}.\)</span></p>
<p><span class="math inline">\(\textbf{Code:}\)</span></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>generate.repar.pareto &lt;-<span class="st"> </span><span class="cf">function</span>(n, beta, r){</span>
<span id="cb7-2"><a href="#cb7-2"></a>  U &lt;-<span class="st"> </span><span class="kw">runif</span>(n)</span>
<span id="cb7-3"><a href="#cb7-3"></a>  P &lt;-<span class="st"> </span>beta <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>((<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>U)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span>r)) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb7-4"><a href="#cb7-4"></a>  <span class="kw">return</span> (P)</span>
<span id="cb7-5"><a href="#cb7-5"></a>}</span>
<span id="cb7-6"><a href="#cb7-6"></a></span>
<span id="cb7-7"><a href="#cb7-7"></a><span class="kw">set.seed</span>(<span class="dv">929</span>)</span>
<span id="cb7-8"><a href="#cb7-8"></a>beta &lt;-<span class="st"> </span><span class="dv">2</span>; r &lt;-<span class="st"> </span><span class="dv">4</span></span>
<span id="cb7-9"><a href="#cb7-9"></a>P &lt;-<span class="st"> </span><span class="kw">generate.repar.pareto</span>(<span class="fl">1e3</span>, beta, r)</span>
<span id="cb7-10"><a href="#cb7-10"></a><span class="kw">hist</span>(P, <span class="dt">breaks =</span> <span class="dv">50</span>, <span class="dt">prob=</span><span class="ot">TRUE</span>, <span class="dt">main=</span><span class="st">&quot;Histogram of Pareto(2,4)&quot;</span>)</span>
<span id="cb7-11"><a href="#cb7-11"></a>y &lt;-<span class="st"> </span><span class="kw">sort</span>(P)</span>
<span id="cb7-12"><a href="#cb7-12"></a>fy &lt;-<span class="st"> </span>r <span class="op">*</span><span class="st"> </span>beta<span class="op">^</span>r <span class="op">*</span><span class="st"> </span>(beta <span class="op">+</span><span class="st"> </span>y)<span class="op">^</span>(<span class="op">-</span>(r <span class="op">+</span><span class="st"> </span><span class="dv">1</span>))</span>
<span id="cb7-13"><a href="#cb7-13"></a><span class="kw">lines</span>(y, fy, <span class="dt">lty=</span><span class="dv">1</span>, <span class="dt">col=</span><span class="st">&quot;green&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="homework-2" class="section level1">
<h1>Homework 2</h1>
<div id="section-4" class="section level2">
<h2>5.1</h2>
<p>Compute a Monte Carlo estimate of <span class="math display">\[\int_{0}^{\pi/3} \sin t dt\]</span> and compare your estimate with the exact value of the integral.</p>
<p><span class="math inline">\(\textbf{Solution:}\)</span></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">set.seed</span>(<span class="dv">1013</span>)</span>
<span id="cb8-2"><a href="#cb8-2"></a>m &lt;-<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb8-3"><a href="#cb8-3"></a>U &lt;-<span class="st"> </span><span class="kw">runif</span>(m, <span class="dv">0</span>, pi<span class="op">/</span><span class="dv">3</span>)</span>
<span id="cb8-4"><a href="#cb8-4"></a>theta.hat &lt;-<span class="st"> </span>pi<span class="op">/</span><span class="dv">3</span> <span class="op">*</span><span class="st"> </span><span class="kw">mean</span>(<span class="kw">sin</span>(U))</span>
<span id="cb8-5"><a href="#cb8-5"></a>theta.exact &lt;-<span class="st"> </span><span class="kw">integrate</span>(<span class="cf">function</span>(x){<span class="kw">sin</span>(x)}, <span class="dv">0</span>, pi<span class="op">/</span><span class="dv">3</span>)<span class="op">$</span>value</span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="kw">cat</span>(<span class="st">&quot;The estimated value of the integral is&quot;</span>, theta.hat)</span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="co">#&gt; The estimated value of the integral is 0.500367</span></span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="kw">cat</span>(<span class="st">&quot;The exact value of the integral is&quot;</span>, theta.exact)</span>
<span id="cb8-9"><a href="#cb8-9"></a><span class="co">#&gt; The exact value of the integral is 0.5</span></span></code></pre></div>
</div>
<div id="section-5" class="section level2">
<h2>5.7</h2>
<p>Refer to Exercise 5.6. Use a Monte Carlo simulation to estimate <span class="math inline">\(\theta\)</span> by the antithetic variate approach and by the simple Monte Carlo method, where <span class="math display">\[\theta=\int_{0}^{1} e^x dx.\]</span> Compute an empirical estimate of the percent reduction in variance using the antithetic variate. Compare the result with the theoretical value from Exercise 5.6.</p>
<p><span class="math inline">\(\textbf{Solution:}\)</span></p>
<p><span class="math inline">\(\text{Cov}(e^U, e^{1-U})=E(e^Ue^{1-U}) - E(e^U)E(e^{1-U})=e-(e-1)^2.\)</span></p>
<p><span class="math inline">\(\text{Var}(e^U)=\text{Var}(e^{1-U})=E(e^{2U}) - (E(e^U))^2=\frac12(e^2-1)-(e-1)^2.\)</span></p>
<p>Suppose <span class="math inline">\(\hat{\theta}_1\)</span> is the simple MC estimator and <span class="math inline">\(\hat{\theta}_2\)</span> is the antithetic estimator, then the variance can be calculated:</p>
<p><span class="math display">\[\text{Var}(\hat{\theta}_1)=\text{Var}(\frac{1}{2}(e^U + e^U))=\frac{1}{2}\text{Var}(e^U)=\frac{1}{2}(\frac12(e^2-1)-(e-1)^2)=\frac{1}{2}(-\frac{1}{2}e^2+2e-\frac{3}{2}).\]</span></p>
<p><span class="math display">\[\text{Var}(\hat{\theta}_2)=\text{Var}(\frac{1}{2}(e^U+e^{1-U}))=\frac{1}{4}(2\text{Var}(e^U)+2\text{Cov}(e^U, e^{1-U}))=\frac{1}{2}(-\frac{3}{2}e^2 + 5e - \frac{5}{2}).\]</span></p>
<p>The theoretical variace reduction is <span class="math display">\[\frac{\text{Var}(\hat{\theta}_1)-\text{Var}(\hat{\theta}_2)}{\text{Var}(\hat{\theta}_1)}=\frac{e^2 - 3e + 1}{\frac{1}{2}e^2 + 2e - \frac{3}{2}}=0.9676701\]</span></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">set.seed</span>(<span class="dv">1014</span>)</span>
<span id="cb9-2"><a href="#cb9-2"></a>MC.integral &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">R =</span> <span class="dv">10000</span>, <span class="dt">antithetic =</span> <span class="ot">TRUE</span>) {</span>
<span id="cb9-3"><a href="#cb9-3"></a>  u &lt;-<span class="st"> </span><span class="kw">runif</span>(R<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb9-4"><a href="#cb9-4"></a>  <span class="cf">if</span> (<span class="op">!</span>antithetic) v &lt;-<span class="st"> </span><span class="kw">runif</span>(R<span class="op">/</span><span class="dv">2</span>) <span class="cf">else</span> v &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>u</span>
<span id="cb9-5"><a href="#cb9-5"></a>  u &lt;-<span class="st"> </span><span class="kw">c</span>(u, v)</span>
<span id="cb9-6"><a href="#cb9-6"></a>  integral &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">exp</span>(u))</span>
<span id="cb9-7"><a href="#cb9-7"></a>  integral</span>
<span id="cb9-8"><a href="#cb9-8"></a>}</span>
<span id="cb9-9"><a href="#cb9-9"></a>MC.anti &lt;-<span class="st"> </span>MC.mc &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">1000</span>)</span>
<span id="cb9-10"><a href="#cb9-10"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>){</span>
<span id="cb9-11"><a href="#cb9-11"></a>  MC.anti[i] &lt;-<span class="st"> </span><span class="kw">MC.integral</span>(<span class="dv">10000</span>, <span class="dt">antithetic =</span> <span class="ot">TRUE</span>)</span>
<span id="cb9-12"><a href="#cb9-12"></a>  MC.mc[i] &lt;-<span class="st"> </span><span class="kw">MC.integral</span>(<span class="dv">10000</span>, <span class="dt">antithetic =</span> <span class="ot">FALSE</span>)</span>
<span id="cb9-13"><a href="#cb9-13"></a>}</span>
<span id="cb9-14"><a href="#cb9-14"></a><span class="kw">cat</span>(<span class="st">&quot;The empirical percent of variance reduction using antithetic variate is&quot;</span>, </span>
<span id="cb9-15"><a href="#cb9-15"></a>    (<span class="kw">var</span>(MC.mc) <span class="op">-</span><span class="st"> </span><span class="kw">var</span>(MC.anti)) <span class="op">/</span><span class="st"> </span><span class="kw">var</span>(MC.mc))</span>
<span id="cb9-16"><a href="#cb9-16"></a><span class="co">#&gt; The empirical percent of variance reduction using antithetic variate is 0.9643701</span></span>
<span id="cb9-17"><a href="#cb9-17"></a><span class="kw">cat</span>(<span class="st">&quot;The theoretical percent of variance reduction using antithetic variate is&quot;</span>, </span>
<span id="cb9-18"><a href="#cb9-18"></a>    (<span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">-</span><span class="st"> </span><span class="dv">3</span><span class="op">*</span><span class="kw">exp</span>(<span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>) <span class="op">/</span><span class="st"> </span>(<span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="dv">1</span>) <span class="op">-</span><span class="st"> </span><span class="dv">3</span><span class="op">/</span><span class="dv">2</span>))</span>
<span id="cb9-19"><a href="#cb9-19"></a><span class="co">#&gt; The theoretical percent of variance reduction using antithetic variate is 0.9676701</span></span>
<span id="cb9-20"><a href="#cb9-20"></a><span class="kw">cat</span>(<span class="st">&quot;The estimate using simple Monte Carlo method is&quot;</span>, <span class="kw">mean</span>(MC.mc), <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>, </span>
<span id="cb9-21"><a href="#cb9-21"></a>    <span class="st">&quot;the estimate using antithetic variate is&quot;</span>, <span class="kw">mean</span>(MC.anti), <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>,</span>
<span id="cb9-22"><a href="#cb9-22"></a>    <span class="st">&quot;the theoretical value is&quot;</span>, <span class="kw">exp</span>(<span class="dv">1</span>) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb9-23"><a href="#cb9-23"></a><span class="co">#&gt; The estimate using simple Monte Carlo method is 1.718366 </span></span>
<span id="cb9-24"><a href="#cb9-24"></a><span class="co">#&gt;  the estimate using antithetic variate is 1.718243 </span></span>
<span id="cb9-25"><a href="#cb9-25"></a><span class="co">#&gt;  the theoretical value is 1.718282</span></span></code></pre></div>
</div>
<div id="section-6" class="section level2">
<h2>5.11</h2>
<p>If <span class="math inline">\(\hat{\theta}_1\)</span> and <span class="math inline">\(\hat{\theta}_2\)</span> are unbiased estimators of <span class="math inline">\(\theta\)</span>, and <span class="math inline">\(\hat{\theta}_1\)</span> and <span class="math inline">\(\hat{\theta}_2\)</span> are antithetic, we derived that <span class="math inline">\(c^{*}=1/2\)</span> is the optimal constant that minimizes the variance of <span class="math inline">\(\hat{\theta}_c=c\hat{\theta}_1+(1-c)\hat{\theta}_2\)</span>. Derive <span class="math inline">\(c^{*}\)</span> for the general case.</p>
<p><span class="math inline">\(\textbf{Solution:}\)</span></p>
<p><span class="math display">\[\begin{aligned}
\text{Var}(\hat{\theta}_c) &amp;= \text{Var}(c\hat{\theta}_1 + (1-c)\hat{\theta}_2) \\
&amp;= c^2 \text{Var}(\hat{\theta}_1) + (1-c)^2\text{Var}(\hat{\theta}_2) + 2c(1-c)\text{Cov}(\hat{\theta}_1, \hat{\theta}_2) \\
&amp;= \left(\text{Var}(\hat{\theta}_1) + \text{Var}(\hat{\theta}_2) - 2\text{Cov}(\hat{\theta}_1, \hat{\theta}_2) \right) c^2 + 2(\text{Cov}(\hat{\theta}_1, \hat{\theta}_2)-\text{Var}(\hat{\theta}_2))c - \text{Var}(\hat{\theta}_2) \\
&amp;= \text{Var}(\hat{\theta}_1 - \hat{\theta}_2) c^2 + 2(\text{Cov}(\hat{\theta}_1, \hat{\theta}_2)-\text{Var}(\hat{\theta}_2))c - \text{Var}(\hat{\theta}_2).
\end{aligned}\]</span></p>
<p>Treat the formula above as a quadratic function of <span class="math inline">\(c\)</span>. Obviously, the function reaches its minimum at <span class="math display">\[c^*=-\frac{\text{Cov}(\hat{\theta}_1, \hat{\theta}_2)-\text{Var}(\hat{\theta}_2)}{\text{Var}(\hat{\theta}_1 - \hat{\theta}_2)}.\]</span></p>
</div>
</div>
<div id="homework-3" class="section level1">
<h1>Homework 3</h1>
<div id="section-7" class="section level2">
<h2>5.13</h2>
<p>Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1, \infty)\)</span> and are ‘close’ to <span class="math display">\[g(x)=\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}, x&gt;1\]</span>. Which of your two importance functions should produce the smaller variance in estimating <span class="math display">\[g(x)=\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}, x&gt;1\]</span> by importance sampling? Explain.</p>
<p><span class="math inline">\(\textbf{Solution:}\)</span></p>
<p>First, display a graph of <span class="math inline">\(g(x)\)</span> to observe its shape.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>g &lt;-<span class="st"> </span><span class="cf">function</span>(x){</span>
<span id="cb10-2"><a href="#cb10-2"></a>  <span class="kw">return</span> (x<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi) <span class="op">*</span><span class="st"> </span>(x<span class="op">&gt;</span><span class="dv">1</span>))</span>
<span id="cb10-3"><a href="#cb10-3"></a>}</span>
<span id="cb10-4"><a href="#cb10-4"></a></span>
<span id="cb10-5"><a href="#cb10-5"></a><span class="kw">curve</span>(<span class="kw">g</span>(x), <span class="dv">1</span>, <span class="dv">5</span>, <span class="dt">lty=</span><span class="dv">1</span>, <span class="dt">col=</span><span class="dv">1</span>, <span class="dt">main=</span><span class="kw">expression</span>(<span class="kw">g</span>(x)<span class="op">==</span>x<span class="op">^</span><span class="dv">2</span><span class="op">*</span>e<span class="op">^</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>According to the shape of <span class="math inline">\(g(x)\)</span>, we can choose gamma or normal distribution to fit <span class="math inline">\(g(x)\)</span>. The following graph shows the density function <span class="math inline">\(g(x)\)</span>, <span class="math inline">\(f_1(x)=\frac{\lambda^{\alpha}}{\Gamma(\alpha)}(x-1)^{\alpha-1}e^{-\lambda (x-1)}, where \quad \lambda=1.5, \alpha=2\)</span>, <span class="math inline">\(f_2(x)=\frac{1}{\sqrt{2\pi}\sigma} e^{-\frac{(x-\mu)^2}{2\sigma^2}}, where \quad \mu=1.5, \sigma=1.\)</span></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="fl">0.01</span>)</span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="kw">curve</span>(<span class="kw">g</span>(x), <span class="dv">1</span>, <span class="dv">5</span>, <span class="dt">lty=</span><span class="dv">1</span>, <span class="dt">col=</span><span class="dv">1</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.8</span>), <span class="dt">ylab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="kw">lines</span>(x, <span class="kw">dgamma</span>(x <span class="op">-</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>), <span class="dt">lty=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="dv">2</span>)</span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="kw">lines</span>(x, <span class="kw">dnorm</span>(x, <span class="fl">1.5</span>, <span class="dv">1</span>), <span class="dt">lty=</span><span class="dv">3</span>, <span class="dt">col=</span><span class="dv">3</span>)</span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="kw">legend</span>(<span class="st">&quot;right&quot;</span>, <span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&quot;g(x)&quot;</span>, <span class="st">&quot;f1(x)&quot;</span>, <span class="st">&quot;f2(x)&quot;</span>), <span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="dt">col=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We should expect that <span class="math inline">\(f_2(x)\)</span> can produce smaller variance because <span class="math inline">\(g(x) / f_2(x)\)</span> is closer to a constant function than <span class="math inline">\(g(x) / f_1(x)\)</span>.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="fl">0.01</span>)</span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="kw">plot</span>(<span class="kw">g</span>(x) <span class="op">/</span><span class="st"> </span><span class="kw">dgamma</span>(x <span class="op">-</span><span class="st"> </span><span class="dv">1</span>, <span class="fl">1.5</span>, <span class="dv">2</span>), </span>
<span id="cb12-3"><a href="#cb12-3"></a>     <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">lty=</span><span class="dv">1</span>, <span class="dt">col=</span><span class="dv">1</span>, <span class="dt">lwd=</span><span class="dv">3</span>, <span class="dt">xlab=</span><span class="st">&quot;x&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;g(x) / f(x)&quot;</span>)</span>
<span id="cb12-4"><a href="#cb12-4"></a><span class="kw">lines</span>(<span class="kw">g</span>(x) <span class="op">/</span><span class="st"> </span><span class="kw">dnorm</span>(x, <span class="fl">1.5</span>, <span class="dv">1</span>), <span class="dt">lty=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="dv">2</span>, <span class="dt">lwd=</span><span class="dv">3</span>)</span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="kw">legend</span>(<span class="st">&quot;right&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;g(x)/f1(x)&quot;</span>, <span class="st">&quot;g(x)/f2(x)&quot;</span>), <span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="dt">col=</span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb12-6"><a href="#cb12-6"></a><span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">at=</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="section-8" class="section level2">
<h2>5.15</h2>
<p>Obtain the stratified importance sampling estimate of <span class="math display">\[\int_{0}^{1} \frac{e^{-x}}{1+x^2}dx.\]</span> and compare it with the result of Example 5.10.</p>
<p><span class="math inline">\(\textbf{Solution:}\)</span></p>
<p>First, we should make some correction for the density function. On the <span class="math inline">\(j^{th}\)</span> subinterval, variables are generated from density function <span class="math display">\[f_j(x)=\frac{e^{-x}}{e^{-(j-1)/5} - e^{-j/5}}, x \in [\frac{j-1}{5}, \frac{j}{5}].\]</span></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="kw">set.seed</span>(<span class="dv">1020</span>)</span>
<span id="cb13-2"><a href="#cb13-2"></a>SISE &lt;-<span class="st"> </span><span class="cf">function</span>(k){</span>
<span id="cb13-3"><a href="#cb13-3"></a>  M &lt;-<span class="st"> </span><span class="fl">1e4</span></span>
<span id="cb13-4"><a href="#cb13-4"></a>  m &lt;-<span class="st"> </span>M <span class="op">/</span><span class="st"> </span>k</span>
<span id="cb13-5"><a href="#cb13-5"></a>  si &lt;-<span class="st"> </span>v &lt;-<span class="st"> </span><span class="kw">numeric</span>(k)</span>
<span id="cb13-6"><a href="#cb13-6"></a>  </span>
<span id="cb13-7"><a href="#cb13-7"></a>  g &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">exp</span>(<span class="op">-</span>x) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb13-8"><a href="#cb13-8"></a>  f &lt;-<span class="st"> </span><span class="cf">function</span>(x, j) <span class="kw">exp</span>(<span class="op">-</span>x) <span class="op">/</span><span class="st"> </span>(<span class="kw">exp</span>(<span class="op">-</span>(j <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">/</span><span class="st"> </span>k) <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>j <span class="op">/</span><span class="st"> </span>k))</span>
<span id="cb13-9"><a href="#cb13-9"></a>  </span>
<span id="cb13-10"><a href="#cb13-10"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k){</span>
<span id="cb13-11"><a href="#cb13-11"></a>    r &lt;-<span class="st"> </span><span class="kw">runif</span>(m, (j<span class="dv">-1</span>) <span class="op">/</span><span class="st"> </span>k, j <span class="op">/</span><span class="st"> </span>k)</span>
<span id="cb13-12"><a href="#cb13-12"></a>    x &lt;-<span class="st"> </span><span class="op">-</span><span class="kw">log</span>(<span class="kw">exp</span>(<span class="op">-</span>(j <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">/</span><span class="st"> </span>k) <span class="op">-</span><span class="st"> </span>(<span class="kw">exp</span>(<span class="op">-</span>(j <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">/</span><span class="st"> </span>k) <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>j <span class="op">/</span><span class="st"> </span>k))<span class="op">*</span>r)</span>
<span id="cb13-13"><a href="#cb13-13"></a>    gf &lt;-<span class="st"> </span><span class="kw">g</span>(x) <span class="op">/</span><span class="st"> </span><span class="kw">f</span>(x, j)</span>
<span id="cb13-14"><a href="#cb13-14"></a>    si[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(gf)</span>
<span id="cb13-15"><a href="#cb13-15"></a>    v[j] &lt;-<span class="st"> </span><span class="kw">var</span>(gf)</span>
<span id="cb13-16"><a href="#cb13-16"></a>  }</span>
<span id="cb13-17"><a href="#cb13-17"></a>  <span class="kw">return</span> (<span class="kw">list</span>(<span class="dt">si=</span>si, <span class="dt">v=</span>v))</span>
<span id="cb13-18"><a href="#cb13-18"></a>}</span>
<span id="cb13-19"><a href="#cb13-19"></a></span>
<span id="cb13-20"><a href="#cb13-20"></a>result.sise &lt;-<span class="st"> </span><span class="kw">SISE</span>(<span class="dv">5</span>)</span>
<span id="cb13-21"><a href="#cb13-21"></a><span class="kw">cat</span>(<span class="st">&quot;The value of integral is &quot;</span>, <span class="kw">sum</span>(result.sise<span class="op">$</span>si), <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb13-22"><a href="#cb13-22"></a><span class="co">#&gt; The value of integral is  0.5241767</span></span>
<span id="cb13-23"><a href="#cb13-23"></a><span class="kw">cat</span>(<span class="st">&quot;The estimated variance is &quot;</span>, <span class="kw">mean</span>(result.sise<span class="op">$</span>v))</span>
<span id="cb13-24"><a href="#cb13-24"></a><span class="co">#&gt; The estimated variance is  4.388291e-07</span></span></code></pre></div>
<p>If we use importance function <span class="math inline">\(f_3(x)=e^{-x} / (1-e^{-1})\)</span> and without stratification, the estimated value of integral and its variance can be calculated as follows:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="kw">set.seed</span>(<span class="dv">1020</span>)</span>
<span id="cb14-2"><a href="#cb14-2"></a>result.sise &lt;-<span class="st"> </span><span class="kw">SISE</span>(<span class="dv">1</span>)</span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="kw">cat</span>(<span class="st">&quot;The value of integral is &quot;</span>, <span class="kw">sum</span>(result.sise<span class="op">$</span>si), <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb14-4"><a href="#cb14-4"></a><span class="co">#&gt; The value of integral is  0.5232581</span></span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="kw">cat</span>(<span class="st">&quot;The estimated variance is &quot;</span>, <span class="kw">mean</span>(result.sise<span class="op">$</span>v))</span>
<span id="cb14-6"><a href="#cb14-6"></a><span class="co">#&gt; The estimated variance is  0.00957218</span></span></code></pre></div>
<p>It can be seen that SISE has smaller variance than the estimate without stratification.</p>
</div>
<div id="section-9" class="section level2">
<h2>6.4</h2>
<p>Suppose that <span class="math inline">\(X_1,\cdots,X_n\)</span> are a random sample from a lognormal distribution with unknown parameters. Construct a 95% confidence interval for the parameter <span class="math inline">\(\mu\)</span>. Use a Monte Carlo method to obtain an empirical estimate of the confidence level.</p>
<p><span class="math inline">\(\textbf{Solution:}\)</span></p>
<p>We know that if <span class="math inline">\(X \sim lognormal(\mu, \sigma^2)\)</span>, <span class="math inline">\(\ln X \sim N(\mu, \sigma^2).\)</span> Let <span class="math inline">\(Y_i = \ln X_i\)</span>, then we can treat this problem of as giving a confidence interval of <span class="math inline">\(\mu\)</span> when <span class="math inline">\(\sigma^2\)</span> is unknown under normal distribution. It is easy to derive that <span class="math display">\[\frac{\bar{Y}-\mu}{W / \sqrt{n}} \sim t(n-1),\]</span> where <span class="math display">\[W^2=\frac{1}{n-1}\sum_{i=1}^{n}(\ln X_i - \frac{1}{n}\sum_{i=1}^{n} \ln X_i)^2.\]</span> So, the <span class="math inline">\(100(1-\alpha)\)</span>% confidence interval of <span class="math inline">\(\mu\)</span> is <span class="math display">\[\left(\frac{1}{n}\sum_{i=1}^{n} \ln X_i - t_{1-\alpha/2}(n-1) \frac{W}{\sqrt{n}},\frac{1}{n}\sum_{i=1}^{n} \ln X_i + t_{1-\alpha/2}(n-1) \frac{W}{\sqrt{n}} \right).\]</span></p>
<p>In the following experiment, we set true <span class="math inline">\(\mu=0, \sigma=1\)</span>, and calculate the empirical covering probability. The empirical confidence level is 0.9496.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="kw">set.seed</span>(<span class="dv">1020</span>)</span>
<span id="cb15-2"><a href="#cb15-2"></a>n &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb15-3"><a href="#cb15-3"></a>CI &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="fl">1e4</span>, <span class="dt">expr=</span>{</span>
<span id="cb15-4"><a href="#cb15-4"></a>  x &lt;-<span class="st"> </span><span class="kw">rlnorm</span>(n)</span>
<span id="cb15-5"><a href="#cb15-5"></a>  y &lt;-<span class="st"> </span><span class="kw">log</span>(x)</span>
<span id="cb15-6"><a href="#cb15-6"></a>  ybar &lt;-<span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb15-7"><a href="#cb15-7"></a>  se &lt;-<span class="st"> </span><span class="kw">sd</span>(y) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(n)</span>
<span id="cb15-8"><a href="#cb15-8"></a>  ybar <span class="op">+</span><span class="st"> </span>se <span class="op">*</span><span class="st"> </span><span class="kw">qt</span>(<span class="kw">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>), <span class="dt">df=</span>n<span class="dv">-1</span>)</span>
<span id="cb15-9"><a href="#cb15-9"></a>})</span>
<span id="cb15-10"><a href="#cb15-10"></a>L &lt;-<span class="st"> </span>CI[<span class="dv">1</span>, ]</span>
<span id="cb15-11"><a href="#cb15-11"></a>U &lt;-<span class="st"> </span>CI[<span class="dv">2</span>, ]</span>
<span id="cb15-12"><a href="#cb15-12"></a>cover &lt;-<span class="st"> </span><span class="kw">sum</span>((L <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&amp;</span><span class="st"> </span>(U <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span>))</span>
<span id="cb15-13"><a href="#cb15-13"></a><span class="kw">cat</span>(<span class="st">&quot;The empirical covering probability is&quot;</span>, cover <span class="op">/</span><span class="st"> </span><span class="kw">ncol</span>(CI))</span>
<span id="cb15-14"><a href="#cb15-14"></a><span class="co">#&gt; The empirical covering probability is 0.9496</span></span></code></pre></div>
</div>
<div id="section-10" class="section level2">
<h2>6.5</h2>
<p>Suppose a 95% symmetric <span class="math inline">\(t\)</span>-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the confidence interval covers the mean is not necessarily equal to 0.95. Use a Monte Carlo experiment to estimate the coverage probability of the <span class="math inline">\(t\)</span>-interval for random samples of <span class="math inline">\(\chi^2(2)\)</span> data with sample size <span class="math inline">\(n=20\)</span>. Compare your <span class="math inline">\(t\)</span>-interval results with the simulation results in Example 6.4. (The <span class="math inline">\(t\)</span>-interval should be more robust to departures from normality than the interval for variance.)</p>
<p><span class="math inline">\(\textbf{Solution:}\)</span></p>
<p>There are 92.34% of intervals that contain true mean value <span class="math inline">\(\mu=2\)</span>. In Example 6.4, there are only 77.3% of intervals that contain true variance <span class="math inline">\(\sigma^2=4\)</span>. This shows that <span class="math inline">\(t\)</span>-interval is more robust to departures from normality than the interval for variance.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="kw">set.seed</span>(<span class="dv">1020</span>)</span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="co">#&gt; </span></span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="co">#&gt; 载入程辑包：&#39;dplyr&#39;</span></span>
<span id="cb16-5"><a href="#cb16-5"></a><span class="co">#&gt; The following objects are masked from &#39;package:stats&#39;:</span></span>
<span id="cb16-6"><a href="#cb16-6"></a><span class="co">#&gt; </span></span>
<span id="cb16-7"><a href="#cb16-7"></a><span class="co">#&gt;     filter, lag</span></span>
<span id="cb16-8"><a href="#cb16-8"></a><span class="co">#&gt; The following objects are masked from &#39;package:base&#39;:</span></span>
<span id="cb16-9"><a href="#cb16-9"></a><span class="co">#&gt; </span></span>
<span id="cb16-10"><a href="#cb16-10"></a><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span id="cb16-11"><a href="#cb16-11"></a>m &lt;-<span class="st"> </span><span class="fl">1e4</span> </span>
<span id="cb16-12"><a href="#cb16-12"></a>n &lt;-<span class="st"> </span><span class="dv">20</span> </span>
<span id="cb16-13"><a href="#cb16-13"></a>mu &lt;-<span class="st"> </span><span class="dv">2</span> </span>
<span id="cb16-14"><a href="#cb16-14"></a>cover &lt;-<span class="st"> </span><span class="dv">0</span> </span>
<span id="cb16-15"><a href="#cb16-15"></a>interval &lt;-<span class="st"> </span><span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</span>
<span id="cb16-16"><a href="#cb16-16"></a>  x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n, <span class="dt">df=</span><span class="dv">2</span>)</span>
<span id="cb16-17"><a href="#cb16-17"></a>  <span class="kw">mean</span>(x) <span class="op">+</span><span class="st"> </span><span class="kw">qt</span>(<span class="kw">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>), <span class="dt">df=</span>n<span class="dv">-1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">sd</span>(x) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(n)</span>
<span id="cb16-18"><a href="#cb16-18"></a>})</span>
<span id="cb16-19"><a href="#cb16-19"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb16-20"><a href="#cb16-20"></a>  cover &lt;-<span class="st"> </span>cover <span class="op">+</span><span class="st"> </span><span class="kw">between</span>(mu, interval[, i][<span class="dv">1</span>], interval[, i][<span class="dv">2</span>])</span>
<span id="cb16-21"><a href="#cb16-21"></a>}</span>
<span id="cb16-22"><a href="#cb16-22"></a><span class="kw">cat</span>(<span class="st">&quot;The empirical covering probability is &quot;</span>, cover <span class="op">/</span><span class="st"> </span>m)</span>
<span id="cb16-23"><a href="#cb16-23"></a><span class="co">#&gt; The empirical covering probability is  0.9234</span></span></code></pre></div>
</div>
</div>
<div id="homework-4" class="section level1">
<h1>Homework 4</h1>
<div id="section-11" class="section level2">
<h2>6.7</h2>
<p>Estimate the power of the skewness test of normality against symmetric Beta(<span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\alpha\)</span>) distributions and comment on the results. Are the results different for heavy-tailed symmetric alternatives such as <span class="math inline">\(t(\nu)\)</span>?</p>
<p><span class="math inline">\(\textbf{Solution:}\)</span></p>
<p>In this simulation, let sample size <span class="math inline">\(n=30\)</span>, <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\nu\)</span> vary from 1 to 10. For every <span class="math inline">\(\alpha\)</span>(<span class="math inline">\(\mu\)</span>), repeat the experiment 10000 times.</p>
<p>For Beta(<span class="math inline">\(\alpha, \alpha\)</span>):</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="kw">set.seed</span>(<span class="dv">1027</span>)</span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="kw">library</span>(e1071) <span class="co">#for `skewness()` function`</span></span>
<span id="cb17-3"><a href="#cb17-3"></a>n &lt;-<span class="st"> </span><span class="dv">30</span></span>
<span id="cb17-4"><a href="#cb17-4"></a>ab &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">10</span></span>
<span id="cb17-5"><a href="#cb17-5"></a>m &lt;-<span class="st"> </span><span class="fl">1e4</span></span>
<span id="cb17-6"><a href="#cb17-6"></a>cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="fl">0.05</span><span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span> <span class="op">*</span><span class="st"> </span>(n <span class="op">-</span><span class="st"> </span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span>((n <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)<span class="op">*</span>(n <span class="op">+</span><span class="st"> </span><span class="dv">3</span>))))</span>
<span id="cb17-7"><a href="#cb17-7"></a>pwr.beta &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(ab))</span>
<span id="cb17-8"><a href="#cb17-8"></a>sktest &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb17-9"><a href="#cb17-9"></a></span>
<span id="cb17-10"><a href="#cb17-10"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(ab)){</span>
<span id="cb17-11"><a href="#cb17-11"></a>  a &lt;-<span class="st"> </span>ab[i]</span>
<span id="cb17-12"><a href="#cb17-12"></a>  sktest &lt;-<span class="st"> </span><span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</span>
<span id="cb17-13"><a href="#cb17-13"></a>    x &lt;-<span class="st"> </span><span class="kw">rbeta</span>(n, <span class="dt">shape1 =</span> a, <span class="dt">shape2 =</span> a)</span>
<span id="cb17-14"><a href="#cb17-14"></a>    <span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">skewness</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv)</span>
<span id="cb17-15"><a href="#cb17-15"></a>  })</span>
<span id="cb17-16"><a href="#cb17-16"></a>  pwr.beta[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktest)</span>
<span id="cb17-17"><a href="#cb17-17"></a>}</span></code></pre></div>
<p>For <span class="math inline">\(t(\nu)\)</span>:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>pwr.t &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(ab))</span>
<span id="cb18-2"><a href="#cb18-2"></a>sktest &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb18-3"><a href="#cb18-3"></a></span>
<span id="cb18-4"><a href="#cb18-4"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(ab)){</span>
<span id="cb18-5"><a href="#cb18-5"></a>  nu &lt;-<span class="st"> </span>ab[i]</span>
<span id="cb18-6"><a href="#cb18-6"></a>  sktest &lt;-<span class="st"> </span><span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</span>
<span id="cb18-7"><a href="#cb18-7"></a>    x &lt;-<span class="st"> </span><span class="kw">rt</span>(n, <span class="dt">df=</span>nu)</span>
<span id="cb18-8"><a href="#cb18-8"></a>    <span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">skewness</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv)</span>
<span id="cb18-9"><a href="#cb18-9"></a>  })</span>
<span id="cb18-10"><a href="#cb18-10"></a>  pwr.t[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktest)</span>
<span id="cb18-11"><a href="#cb18-11"></a>}</span></code></pre></div>
<p>We can make a plot of the power vs. degrees of freedom.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="kw">library</span>(ggpubr)</span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="co">#&gt; 载入需要的程辑包：magrittr</span></span>
<span id="cb19-3"><a href="#cb19-3"></a>d &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">df=</span><span class="kw">rep</span>(ab, <span class="dt">time=</span><span class="dv">2</span>), </span>
<span id="cb19-4"><a href="#cb19-4"></a>                <span class="dt">pwr=</span><span class="kw">c</span>(pwr.beta, pwr.t),</span>
<span id="cb19-5"><a href="#cb19-5"></a>                <span class="dt">dis=</span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;Beta&quot;</span>, <span class="st">&quot;t&quot;</span>), <span class="dt">each=</span><span class="dv">10</span>))</span>
<span id="cb19-6"><a href="#cb19-6"></a><span class="kw">ggline</span>(d, <span class="dt">x=</span><span class="st">&quot;df&quot;</span>, <span class="dt">y=</span><span class="st">&quot;pwr&quot;</span>, <span class="dt">group=</span><span class="st">&quot;dis&quot;</span>, <span class="dt">linetype=</span><span class="st">&quot;dis&quot;</span>, <span class="dt">shape=</span><span class="st">&quot;dis&quot;</span>, </span>
<span id="cb19-7"><a href="#cb19-7"></a>       <span class="dt">palette =</span> <span class="kw">c</span>(<span class="st">&quot;#00AFBB&quot;</span>, <span class="st">&quot;#E7B800&quot;</span>), </span>
<span id="cb19-8"><a href="#cb19-8"></a>       <span class="dt">xlab=</span><span class="st">&quot;Parameter&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;power&quot;</span>) <span class="op">+</span><span class="st"> </span>ggthemes<span class="op">::</span><span class="kw">theme_economist</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>For Beta<span class="math inline">\((\alpha, \alpha)\)</span> distribution, the power of the test is constantly small for <span class="math inline">\(\alpha\)</span> varying from 1 to 10. But for <span class="math inline">\(t(\nu)\)</span> distribution, the test is more powerful when the degrees of freedom are small. As <span class="math inline">\(\nu\)</span> grows larger, the power tends to <span class="math inline">\(\alpha\)</span>.</p>
</div>
<div id="section-12" class="section level2">
<h2>6.8</h2>
<p>Refer to Example 6.16. Repeat the simulation, but also compute the F test of equal variance, at significance level <span class="math inline">\(\hat{\alpha} = 0.055\)</span>. Compare the power of the Count Five test and F test for small, medium, and large sample sizes. (Recall that the F test is not applicable for non-normal distributions.)</p>
<p><span class="math inline">\(\textbf{Solution:}\)</span></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="kw">set.seed</span>(<span class="dv">1027</span>)</span>
<span id="cb20-2"><a href="#cb20-2"></a>alpha.hat &lt;-<span class="st"> </span><span class="fl">0.055</span></span>
<span id="cb20-3"><a href="#cb20-3"></a>n &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">1000</span>)</span>
<span id="cb20-4"><a href="#cb20-4"></a>mu1 &lt;-<span class="st"> </span>mu2 &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb20-5"><a href="#cb20-5"></a>sigma1 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb20-6"><a href="#cb20-6"></a>sigma2 &lt;-<span class="st"> </span><span class="fl">1.5</span></span>
<span id="cb20-7"><a href="#cb20-7"></a>m &lt;-<span class="st"> </span><span class="fl">1e4</span></span>
<span id="cb20-8"><a href="#cb20-8"></a>result &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="kw">length</span>(n), <span class="dv">2</span>)</span>
<span id="cb20-9"><a href="#cb20-9"></a></span>
<span id="cb20-10"><a href="#cb20-10"></a>count5test &lt;-<span class="st"> </span><span class="cf">function</span>(x, y){</span>
<span id="cb20-11"><a href="#cb20-11"></a>  X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb20-12"><a href="#cb20-12"></a>  Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb20-13"><a href="#cb20-13"></a>  outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</span>
<span id="cb20-14"><a href="#cb20-14"></a>  outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</span>
<span id="cb20-15"><a href="#cb20-15"></a>  <span class="kw">return</span> (<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>))</span>
<span id="cb20-16"><a href="#cb20-16"></a>}</span>
<span id="cb20-17"><a href="#cb20-17"></a></span>
<span id="cb20-18"><a href="#cb20-18"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)){</span>
<span id="cb20-19"><a href="#cb20-19"></a>  ni &lt;-<span class="st"> </span>n[i]</span>
<span id="cb20-20"><a href="#cb20-20"></a>  tests &lt;-<span class="st"> </span><span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</span>
<span id="cb20-21"><a href="#cb20-21"></a>    x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(ni, mu1, sigma1)</span>
<span id="cb20-22"><a href="#cb20-22"></a>    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(ni, mu2, sigma2)</span>
<span id="cb20-23"><a href="#cb20-23"></a>    Fp &lt;-<span class="st"> </span><span class="kw">var.test</span>(x, y)<span class="op">$</span>p.value</span>
<span id="cb20-24"><a href="#cb20-24"></a>    Ftest &lt;-<span class="st"> </span><span class="kw">as.integer</span>(Fp <span class="op">&lt;=</span><span class="st"> </span>alpha.hat)</span>
<span id="cb20-25"><a href="#cb20-25"></a>    <span class="kw">c</span>(<span class="kw">count5test</span>(x, y), Ftest)</span>
<span id="cb20-26"><a href="#cb20-26"></a>  })</span>
<span id="cb20-27"><a href="#cb20-27"></a>  result[i, ] &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(tests)</span>
<span id="cb20-28"><a href="#cb20-28"></a>}</span>
<span id="cb20-29"><a href="#cb20-29"></a></span>
<span id="cb20-30"><a href="#cb20-30"></a><span class="kw">data.frame</span>(<span class="dt">n=</span>n, <span class="dt">C5=</span>result[, <span class="dv">1</span>], <span class="dt">Fp=</span>result[, <span class="dv">2</span>])</span>
<span id="cb20-31"><a href="#cb20-31"></a><span class="co">#&gt;      n     C5     Fp</span></span>
<span id="cb20-32"><a href="#cb20-32"></a><span class="co">#&gt; 1   10 0.1050 0.2101</span></span>
<span id="cb20-33"><a href="#cb20-33"></a><span class="co">#&gt; 2   20 0.3128 0.4248</span></span>
<span id="cb20-34"><a href="#cb20-34"></a><span class="co">#&gt; 3   50 0.6584 0.8181</span></span>
<span id="cb20-35"><a href="#cb20-35"></a><span class="co">#&gt; 4  100 0.8546 0.9812</span></span>
<span id="cb20-36"><a href="#cb20-36"></a><span class="co">#&gt; 5  500 0.9902 1.0000</span></span>
<span id="cb20-37"><a href="#cb20-37"></a><span class="co">#&gt; 6 1000 0.9977 1.0000</span></span></code></pre></div>
<p>The simulation results suggest that the F-test for equal variance is more powerful in this case, for all sample sizes compared.</p>
</div>
<div id="discussion" class="section level2">
<h2>Discussion</h2>
<p>If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. Can we say the powers are different at 0.05 level?</p>
<ul>
<li>What is the corresponding hypothesis test problem?</li>
<li>What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test?</li>
<li>What information is needed to test your hypothesis?</li>
</ul>
<p><span class="math inline">\(\textbf{Solution:}\)</span></p>
<ul>
<li><p>According to the definition of power, it is the proportion that we reject <span class="math inline">\(H_0\)</span> given <span class="math inline">\(H_0\)</span> is not true. Thus, we can treat this problem as <span class="math display">\[H_0:p_1=p_2 \quad vs. \quad H_1:p_1 \neq p_2.\]</span> Where <span class="math inline">\(p_1\)</span> is the proportion of rejecting <span class="math inline">\(H_0\)</span> using method 1, and <span class="math inline">\(p_2\)</span> is the proportion of rejecting <span class="math inline">\(H_0\)</span> using method 2. From another perspective, let <span class="math inline">\(d\)</span> be the total number of different test results using two methods, i.e., if <span class="math inline">\(H_0\)</span> is rejected under one of the two methods but not rejected under the other method, <span class="math inline">\(d_i=1\)</span>, otherwise <span class="math inline">\(d_i=0\)</span>. Then let <span class="math inline">\(d=\sum_{i=1}^{n}d_i.\)</span> In this situation, the problem can be written as <span class="math inline">\(H_0:d=0 \quad vs. \quad H_1:d &gt;0.\)</span></p></li>
<li><p>We should use Z-test. The test statistic is <span class="math display">\[z=\frac{p_1 - p_2}{\sqrt{\frac{p_1(1-p_1)}{n_1} + \frac{p_2(1-p_2)}{n_2}}} \sim N(0,1).\]</span> Paired <span class="math inline">\(t\)</span>-test is also OK for this hypothesis test if we want to test <span class="math inline">\(H_0:d=0 \quad vs. \quad H_1:d &gt;0.\)</span> The test statistic is <span class="math display">\[t=\frac{\bar{d}}{s_d / \sqrt{n}} \sim t(n-1),\]</span> where <span class="math inline">\(\bar{d}=\frac{1}{n}\sum_{i=1}^{d}d_i, s_d=\left(\frac{1}{n-1}\sum_{i=1}^{n}(d_i-\bar{d})^2\right)^{1/2}.\)</span></p></li>
<li><p>If we use Z-test, we will need no additional information. If we use paired t-test, we will need the paired difference vector <span class="math inline">\(\boldsymbol{d}=(d_1,\cdots,d_n)\)</span>.</p></li>
</ul>
</div>
</div>
<div id="homework-5" class="section level1">
<h1>Homework 5</h1>
<div id="section-13" class="section level2">
<h2>7.1</h2>
<p>Using data <code>law</code> in package <code>bootstrap</code>, Compute a jackknife estimate of the bias and the standard error of the correlation statistic.</p>
<p><span class="math inline">\(\textbf{Solution:}\)</span></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="kw">data</span>(law, <span class="dt">package =</span> <span class="st">&quot;bootstrap&quot;</span>)</span>
<span id="cb21-2"><a href="#cb21-2"></a>n &lt;-<span class="st"> </span><span class="kw">nrow</span>(law)</span>
<span id="cb21-3"><a href="#cb21-3"></a>R.hat &lt;-<span class="st"> </span><span class="kw">cor</span>(law<span class="op">$</span>LSAT, law<span class="op">$</span>GPA)</span>
<span id="cb21-4"><a href="#cb21-4"></a>R.jack &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb21-5"><a href="#cb21-5"></a></span>
<span id="cb21-6"><a href="#cb21-6"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb21-7"><a href="#cb21-7"></a>  x &lt;-<span class="st"> </span>law[<span class="op">-</span>i, ]</span>
<span id="cb21-8"><a href="#cb21-8"></a>  R.jack[i] &lt;-<span class="st"> </span><span class="kw">cor</span>(x[, <span class="dv">1</span>], x[, <span class="dv">2</span>])</span>
<span id="cb21-9"><a href="#cb21-9"></a>}</span>
<span id="cb21-10"><a href="#cb21-10"></a></span>
<span id="cb21-11"><a href="#cb21-11"></a>bias.jack &lt;-<span class="st"> </span>(n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)<span class="op">*</span>(<span class="kw">mean</span>(R.jack) <span class="op">-</span><span class="st"> </span>R.hat)</span>
<span id="cb21-12"><a href="#cb21-12"></a>se.jack &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">var</span>(R.jack) <span class="op">*</span><span class="st"> </span>(n<span class="dv">-1</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>n)</span>
<span id="cb21-13"><a href="#cb21-13"></a><span class="kw">cat</span>(<span class="st">&quot;The jackknife estimate of the bias of correlation statistic is&quot;</span>, bias.jack, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb21-14"><a href="#cb21-14"></a><span class="co">#&gt; The jackknife estimate of the bias of correlation statistic is -0.006473623</span></span>
<span id="cb21-15"><a href="#cb21-15"></a><span class="kw">cat</span>(<span class="st">&quot;The jackknife estimate of the standard error of correlation statistic is&quot;</span>, se.jack)</span>
<span id="cb21-16"><a href="#cb21-16"></a><span class="co">#&gt; The jackknife estimate of the standard error of correlation statistic is 0.1425186</span></span></code></pre></div>
</div>
<div id="section-14" class="section level2">
<h2>7.5</h2>
<p>Refer to the air-conditioning data set <code>aircondit</code> provided in the <code>boot</code> package. Compute 95% bootstrap confidence intervals for the mean time between failures <span class="math inline">\(\frac{1}{\lambda}\)</span> by the standard normal, basic, percentile, and BCa methods. Compare the intervals and explain why they may differ.</p>
<p><span class="math inline">\(\textbf{Solution:}\)</span></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="kw">set.seed</span>(<span class="dv">113</span>)</span>
<span id="cb22-2"><a href="#cb22-2"></a><span class="kw">library</span>(boot)</span>
<span id="cb22-3"><a href="#cb22-3"></a><span class="co">#&gt; </span></span>
<span id="cb22-4"><a href="#cb22-4"></a><span class="co">#&gt; 载入程辑包：&#39;boot&#39;</span></span>
<span id="cb22-5"><a href="#cb22-5"></a><span class="co">#&gt; The following object is masked from &#39;package:lattice&#39;:</span></span>
<span id="cb22-6"><a href="#cb22-6"></a><span class="co">#&gt; </span></span>
<span id="cb22-7"><a href="#cb22-7"></a><span class="co">#&gt;     melanoma</span></span>
<span id="cb22-8"><a href="#cb22-8"></a><span class="kw">data</span>(aircondit, <span class="dt">package=</span><span class="st">&quot;boot&quot;</span>)</span>
<span id="cb22-9"><a href="#cb22-9"></a>x &lt;-<span class="st"> </span>aircondit<span class="op">$</span>hours</span>
<span id="cb22-10"><a href="#cb22-10"></a></span>
<span id="cb22-11"><a href="#cb22-11"></a>boot.func &lt;-<span class="st"> </span><span class="cf">function</span>(x, i){</span>
<span id="cb22-12"><a href="#cb22-12"></a>  <span class="kw">mean</span>(<span class="kw">as.matrix</span>(x[i]))</span>
<span id="cb22-13"><a href="#cb22-13"></a>}</span>
<span id="cb22-14"><a href="#cb22-14"></a></span>
<span id="cb22-15"><a href="#cb22-15"></a>b &lt;-<span class="st"> </span><span class="kw">boot</span>(</span>
<span id="cb22-16"><a href="#cb22-16"></a>  <span class="dt">data =</span> x,</span>
<span id="cb22-17"><a href="#cb22-17"></a>  <span class="dt">statistic =</span> boot.func,</span>
<span id="cb22-18"><a href="#cb22-18"></a>  <span class="dt">R =</span> <span class="dv">1000</span></span>
<span id="cb22-19"><a href="#cb22-19"></a>)</span>
<span id="cb22-20"><a href="#cb22-20"></a></span>
<span id="cb22-21"><a href="#cb22-21"></a><span class="kw">boot.ci</span>(b, <span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>, <span class="st">&quot;perc&quot;</span>, <span class="st">&quot;basic&quot;</span>, <span class="st">&quot;bca&quot;</span>))</span>
<span id="cb22-22"><a href="#cb22-22"></a><span class="co">#&gt; BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS</span></span>
<span id="cb22-23"><a href="#cb22-23"></a><span class="co">#&gt; Based on 1000 bootstrap replicates</span></span>
<span id="cb22-24"><a href="#cb22-24"></a><span class="co">#&gt; </span></span>
<span id="cb22-25"><a href="#cb22-25"></a><span class="co">#&gt; CALL : </span></span>
<span id="cb22-26"><a href="#cb22-26"></a><span class="co">#&gt; boot.ci(boot.out = b, type = c(&quot;norm&quot;, &quot;perc&quot;, &quot;basic&quot;, &quot;bca&quot;))</span></span>
<span id="cb22-27"><a href="#cb22-27"></a><span class="co">#&gt; </span></span>
<span id="cb22-28"><a href="#cb22-28"></a><span class="co">#&gt; Intervals : </span></span>
<span id="cb22-29"><a href="#cb22-29"></a><span class="co">#&gt; Level      Normal              Basic         </span></span>
<span id="cb22-30"><a href="#cb22-30"></a><span class="co">#&gt; 95%   ( 37.6, 181.7 )   ( 31.7, 169.8 )  </span></span>
<span id="cb22-31"><a href="#cb22-31"></a><span class="co">#&gt; </span></span>
<span id="cb22-32"><a href="#cb22-32"></a><span class="co">#&gt; Level     Percentile            BCa          </span></span>
<span id="cb22-33"><a href="#cb22-33"></a><span class="co">#&gt; 95%   ( 46.3, 184.5 )   ( 59.1, 218.1 )  </span></span>
<span id="cb22-34"><a href="#cb22-34"></a><span class="co">#&gt; Calculations and Intervals on Original Scale</span></span>
<span id="cb22-35"><a href="#cb22-35"></a><span class="co">#&gt; Some BCa intervals may be unstable</span></span></code></pre></div>
<p>We can make a QQ-plot to examine whether the data is normally distributed.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="kw">qqnorm</span>(x);<span class="kw">qqline</span>(x)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the QQ-plot, the data is obviously not normal. So the normal interval is not so good. BCa interval adjusts for bias and skewness, so it may be better than percentile interval.</p>
</div>
<div id="section-15" class="section level2">
<h2>7.8</h2>
<p>Obtain the jackknife estimates of bias and standard error of <span class="math display">\[\hat{\theta}=\frac{\hat{\lambda}_1}{\sum_{i=1}^{5}\hat{\lambda}_j}.\]</span></p>
<p><span class="math inline">\(\textbf{Solution:}\)</span></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="kw">set.seed</span>(<span class="dv">1018</span>)</span>
<span id="cb24-2"><a href="#cb24-2"></a><span class="kw">library</span>(boot)</span>
<span id="cb24-3"><a href="#cb24-3"></a><span class="kw">library</span>(bootstrap)</span>
<span id="cb24-4"><a href="#cb24-4"></a><span class="kw">data</span>(scor, <span class="dt">package=</span><span class="st">&quot;bootstrap&quot;</span>)</span>
<span id="cb24-5"><a href="#cb24-5"></a></span>
<span id="cb24-6"><a href="#cb24-6"></a>n &lt;-<span class="st"> </span><span class="kw">nrow</span>(scor)</span>
<span id="cb24-7"><a href="#cb24-7"></a>df &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(scor)</span>
<span id="cb24-8"><a href="#cb24-8"></a>theta.hat &lt;-<span class="st"> </span><span class="kw">eigen</span>(<span class="kw">cov</span>(df))<span class="op">$</span>value[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(<span class="kw">eigen</span>(<span class="kw">cov</span>(df))<span class="op">$</span>value)</span>
<span id="cb24-9"><a href="#cb24-9"></a></span>
<span id="cb24-10"><a href="#cb24-10"></a><span class="co">## jackknife estimate</span></span>
<span id="cb24-11"><a href="#cb24-11"></a>theta.j &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb24-12"><a href="#cb24-12"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb24-13"><a href="#cb24-13"></a>  x &lt;-<span class="st"> </span>df[<span class="op">-</span>i, ]</span>
<span id="cb24-14"><a href="#cb24-14"></a>  lambda &lt;-<span class="st"> </span><span class="kw">eigen</span>(<span class="kw">cov</span>(x))<span class="op">$</span>values</span>
<span id="cb24-15"><a href="#cb24-15"></a>  theta.j[i] &lt;-<span class="st"> </span>lambda[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(lambda)</span>
<span id="cb24-16"><a href="#cb24-16"></a>}</span>
<span id="cb24-17"><a href="#cb24-17"></a>bias.jack &lt;-<span class="st"> </span>(n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(<span class="kw">mean</span>(theta.j) <span class="op">-</span><span class="st"> </span>theta.hat)</span>
<span id="cb24-18"><a href="#cb24-18"></a>se.jack &lt;-<span class="st"> </span>(n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">var</span>(theta.j) <span class="op">/</span><span class="st"> </span>n)</span>
<span id="cb24-19"><a href="#cb24-19"></a></span>
<span id="cb24-20"><a href="#cb24-20"></a><span class="kw">cat</span>(<span class="st">&quot;The jackknife estimate of bias is&quot;</span>, bias.jack, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb24-21"><a href="#cb24-21"></a><span class="co">#&gt; The jackknife estimate of bias is 0.001069139</span></span>
<span id="cb24-22"><a href="#cb24-22"></a><span class="kw">cat</span>(<span class="st">&quot;The jackknife estimate of standard error is&quot;</span>, se.jack)</span>
<span id="cb24-23"><a href="#cb24-23"></a><span class="co">#&gt; The jackknife estimate of standard error is 0.04955231</span></span></code></pre></div>
</div>
<div id="section-16" class="section level2">
<h2>7.11</h2>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best fitting model. Use leave-two-out cross validation to compare the models.</p>
<p><span class="math inline">\(\textbf{Solution:}\)</span></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="cf">if</span> (<span class="op">!</span><span class="kw">require</span>(DAAG)) {</span>
<span id="cb25-2"><a href="#cb25-2"></a>  <span class="kw">install.packages</span>(<span class="st">&quot;DAAG&quot;</span>)</span>
<span id="cb25-3"><a href="#cb25-3"></a>  <span class="kw">library</span>(DAAG)</span>
<span id="cb25-4"><a href="#cb25-4"></a>}</span>
<span id="cb25-5"><a href="#cb25-5"></a><span class="co">#&gt; 载入需要的程辑包：DAAG</span></span>
<span id="cb25-6"><a href="#cb25-6"></a><span class="kw">data</span>(ironslag)</span>
<span id="cb25-7"><a href="#cb25-7"></a>n &lt;-<span class="st"> </span><span class="kw">nrow</span>(ironslag)</span>
<span id="cb25-8"><a href="#cb25-8"></a>N &lt;-<span class="st"> </span><span class="kw">combn</span>(n, <span class="dv">2</span>) <span class="co">#choose all possible combinations C_{n}^{2}</span></span>
<span id="cb25-9"><a href="#cb25-9"></a>e1 &lt;-<span class="st"> </span>e2 &lt;-<span class="st"> </span>e3 &lt;-<span class="st"> </span>e4 &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">dim</span>(N)[<span class="dv">2</span>])</span>
<span id="cb25-10"><a href="#cb25-10"></a></span>
<span id="cb25-11"><a href="#cb25-11"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">dim</span>(N)[<span class="dv">2</span>]){</span>
<span id="cb25-12"><a href="#cb25-12"></a>  lto &lt;-<span class="st"> </span>N[, k] <span class="co"># leave-two-out index</span></span>
<span id="cb25-13"><a href="#cb25-13"></a>  y &lt;-<span class="st"> </span>ironslag[<span class="op">-</span>lto, <span class="dv">2</span>]</span>
<span id="cb25-14"><a href="#cb25-14"></a>  x &lt;-<span class="st"> </span>ironslag[<span class="op">-</span>lto, <span class="dv">1</span>]</span>
<span id="cb25-15"><a href="#cb25-15"></a>  </span>
<span id="cb25-16"><a href="#cb25-16"></a>  J1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x)</span>
<span id="cb25-17"><a href="#cb25-17"></a>  yhat1 &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>]<span class="op">*</span>ironslag[lto, <span class="dv">1</span>]</span>
<span id="cb25-18"><a href="#cb25-18"></a>  e1[k] &lt;-<span class="st"> </span><span class="kw">sum</span>((ironslag[lto, <span class="dv">2</span>] <span class="op">-</span><span class="st"> </span>yhat1)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb25-19"><a href="#cb25-19"></a>  </span>
<span id="cb25-20"><a href="#cb25-20"></a>  J2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>(x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>)))</span>
<span id="cb25-21"><a href="#cb25-21"></a>  yhat2 &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>ironslag[lto, <span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>ironslag[lto, <span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span></span>
<span id="cb25-22"><a href="#cb25-22"></a>  e2[k] &lt;-<span class="st"> </span><span class="kw">sum</span>((ironslag[lto, <span class="dv">2</span>] <span class="op">-</span><span class="st"> </span>yhat2)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb25-23"><a href="#cb25-23"></a>  </span>
<span id="cb25-24"><a href="#cb25-24"></a>  J3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x)</span>
<span id="cb25-25"><a href="#cb25-25"></a>  logyhat3 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>]<span class="op">*</span>ironslag[lto, <span class="dv">1</span>]</span>
<span id="cb25-26"><a href="#cb25-26"></a>  yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3)</span>
<span id="cb25-27"><a href="#cb25-27"></a>  e3[k] &lt;-<span class="st"> </span><span class="kw">sum</span>((ironslag[lto, <span class="dv">2</span>] <span class="op">-</span><span class="st"> </span>yhat3)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb25-28"><a href="#cb25-28"></a>  </span>
<span id="cb25-29"><a href="#cb25-29"></a>  J4 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(x))</span>
<span id="cb25-30"><a href="#cb25-30"></a>  logyhat4 &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>]<span class="op">*</span><span class="kw">log</span>(ironslag[lto, <span class="dv">1</span>])</span>
<span id="cb25-31"><a href="#cb25-31"></a>  yhat4 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat4)</span>
<span id="cb25-32"><a href="#cb25-32"></a>  e4[k] &lt;-<span class="st"> </span><span class="kw">sum</span>((ironslag[lto, <span class="dv">2</span>] <span class="op">-</span><span class="st"> </span>yhat4)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb25-33"><a href="#cb25-33"></a>}</span>
<span id="cb25-34"><a href="#cb25-34"></a></span>
<span id="cb25-35"><a href="#cb25-35"></a><span class="kw">c</span>(<span class="kw">mean</span>(e1), <span class="kw">mean</span>(e2), <span class="kw">mean</span>(e3), <span class="kw">mean</span>(e4))</span>
<span id="cb25-36"><a href="#cb25-36"></a><span class="co">#&gt; [1] 39.14455 35.74037 36.90983 40.93436</span></span></code></pre></div>
<p>Based on minimum prediction error criterion, the minimum prediction error is 35.74037. So we should choose a linear model with quadratic form. We can then use all data to build this model.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>model &lt;-<span class="st"> </span><span class="kw">lm</span>(magnetic<span class="op">~</span>chemical <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">2</span>), <span class="dt">data=</span>ironslag)</span>
<span id="cb26-2"><a href="#cb26-2"></a><span class="kw">summary</span>(model)</span>
<span id="cb26-3"><a href="#cb26-3"></a><span class="co">#&gt; </span></span>
<span id="cb26-4"><a href="#cb26-4"></a><span class="co">#&gt; Call:</span></span>
<span id="cb26-5"><a href="#cb26-5"></a><span class="co">#&gt; lm(formula = magnetic ~ chemical + I(chemical^2), data = ironslag)</span></span>
<span id="cb26-6"><a href="#cb26-6"></a><span class="co">#&gt; </span></span>
<span id="cb26-7"><a href="#cb26-7"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb26-8"><a href="#cb26-8"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb26-9"><a href="#cb26-9"></a><span class="co">#&gt; -8.4335 -2.7006 -0.2754  2.5446 12.2665 </span></span>
<span id="cb26-10"><a href="#cb26-10"></a><span class="co">#&gt; </span></span>
<span id="cb26-11"><a href="#cb26-11"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb26-12"><a href="#cb26-12"></a><span class="co">#&gt;               Estimate Std. Error t value Pr(&gt;|t|)   </span></span>
<span id="cb26-13"><a href="#cb26-13"></a><span class="co">#&gt; (Intercept)   24.49262    9.14657   2.678   0.0100 **</span></span>
<span id="cb26-14"><a href="#cb26-14"></a><span class="co">#&gt; chemical      -1.39334    0.88852  -1.568   0.1232   </span></span>
<span id="cb26-15"><a href="#cb26-15"></a><span class="co">#&gt; I(chemical^2)  0.05452    0.02081   2.620   0.0116 * </span></span>
<span id="cb26-16"><a href="#cb26-16"></a><span class="co">#&gt; ---</span></span>
<span id="cb26-17"><a href="#cb26-17"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb26-18"><a href="#cb26-18"></a><span class="co">#&gt; </span></span>
<span id="cb26-19"><a href="#cb26-19"></a><span class="co">#&gt; Residual standard error: 4.098 on 50 degrees of freedom</span></span>
<span id="cb26-20"><a href="#cb26-20"></a><span class="co">#&gt; Multiple R-squared:  0.5931, Adjusted R-squared:  0.5768 </span></span>
<span id="cb26-21"><a href="#cb26-21"></a><span class="co">#&gt; F-statistic: 36.44 on 2 and 50 DF,  p-value: 1.728e-10</span></span></code></pre></div>
<p>If we use <span class="math inline">\(Y\)</span> to represent <code>magnetic</code>, <span class="math inline">\(X\)</span> to represent <code>chemical</code>, the model can be written as <span class="math display">\[Y=24.49-1.39X+0.05X^2.\]</span></p>
</div>
</div>
<div id="homework-6" class="section level1">
<h1>Homework 6</h1>
<div id="section-17" class="section level2">
<h2>8.3</h2>
<p>The Count 5 criterion is not applicable for unequal sample sizes. Implement a permutation test for equal variance that is based on the maximum outliers statistic that applies when sample sizes are not necessarily equal.</p>
<p><span class="math inline">\(\textbf{Solution:}\)</span></p>
<p>First, compute the maximum outlier statistic based on permutation.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>max.extreme.points &lt;-<span class="st"> </span><span class="cf">function</span>(x, y){</span>
<span id="cb27-2"><a href="#cb27-2"></a>  X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb27-3"><a href="#cb27-3"></a>  Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb27-4"><a href="#cb27-4"></a>  outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</span>
<span id="cb27-5"><a href="#cb27-5"></a>  outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</span>
<span id="cb27-6"><a href="#cb27-6"></a>  <span class="kw">max</span>(<span class="kw">c</span>(outx, outy))</span>
<span id="cb27-7"><a href="#cb27-7"></a>}</span>
<span id="cb27-8"><a href="#cb27-8"></a></span>
<span id="cb27-9"><a href="#cb27-9"></a></span>
<span id="cb27-10"><a href="#cb27-10"></a>maxout &lt;-<span class="st"> </span><span class="cf">function</span>(x, y, R){</span>
<span id="cb27-11"><a href="#cb27-11"></a>  </span>
<span id="cb27-12"><a href="#cb27-12"></a>  <span class="co"># x: a vector representing a sample from population 1</span></span>
<span id="cb27-13"><a href="#cb27-13"></a>  <span class="co"># y: a vector representing a sample from population 2</span></span>
<span id="cb27-14"><a href="#cb27-14"></a>  <span class="co"># R: the number of replicates</span></span>
<span id="cb27-15"><a href="#cb27-15"></a>  <span class="co"># return: a list containing the `maxout` statistic and p value of the permutation test</span></span>
<span id="cb27-16"><a href="#cb27-16"></a>  </span>
<span id="cb27-17"><a href="#cb27-17"></a>  z &lt;-<span class="st"> </span><span class="kw">c</span>(x, y)</span>
<span id="cb27-18"><a href="#cb27-18"></a>  n &lt;-<span class="st"> </span><span class="kw">length</span>(x)</span>
<span id="cb27-19"><a href="#cb27-19"></a>  N &lt;-<span class="st"> </span><span class="kw">length</span>(z)</span>
<span id="cb27-20"><a href="#cb27-20"></a>  </span>
<span id="cb27-21"><a href="#cb27-21"></a>  stat &lt;-<span class="st"> </span><span class="kw">replicate</span>(R, <span class="dt">expr=</span>{</span>
<span id="cb27-22"><a href="#cb27-22"></a>    k &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span>N))</span>
<span id="cb27-23"><a href="#cb27-23"></a>    k1 &lt;-<span class="st"> </span>k[<span class="dv">1</span><span class="op">:</span>n]</span>
<span id="cb27-24"><a href="#cb27-24"></a>    k2 &lt;-<span class="st"> </span>k[(n<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N]</span>
<span id="cb27-25"><a href="#cb27-25"></a>    <span class="kw">max.extreme.points</span>(z[k1], z[k2])</span>
<span id="cb27-26"><a href="#cb27-26"></a>  })</span>
<span id="cb27-27"><a href="#cb27-27"></a>  stat1 &lt;-<span class="st"> </span><span class="kw">max.extreme.points</span>(x, y)</span>
<span id="cb27-28"><a href="#cb27-28"></a>  stat2 &lt;-<span class="st"> </span><span class="kw">c</span>(stat, stat1)</span>
<span id="cb27-29"><a href="#cb27-29"></a></span>
<span id="cb27-30"><a href="#cb27-30"></a>  <span class="kw">return</span> (<span class="kw">list</span>(<span class="dt">estimate=</span>stat1, </span>
<span id="cb27-31"><a href="#cb27-31"></a>               <span class="dt">p.val=</span><span class="kw">mean</span>(stat2 <span class="op">&gt;=</span><span class="st"> </span>stat1)))</span>
<span id="cb27-32"><a href="#cb27-32"></a>}</span></code></pre></div>
<p>In the first example, suppose that the variances of two populations are equal, where <span class="math inline">\(\sigma_1^2=\sigma_2^2=1\)</span>. The sample sizes are <span class="math inline">\(n=30, m=60\)</span> respectively. Do 500 replicates in this test. The p-value is 0.547, so the observed statistic is not significant.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="kw">set.seed</span>(<span class="dv">1110</span>)</span>
<span id="cb28-2"><a href="#cb28-2"></a>n &lt;-<span class="st"> </span><span class="dv">30</span></span>
<span id="cb28-3"><a href="#cb28-3"></a>m &lt;-<span class="st"> </span><span class="dv">60</span></span>
<span id="cb28-4"><a href="#cb28-4"></a>mu1 &lt;-<span class="st"> </span>mu2 &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb28-5"><a href="#cb28-5"></a>sigma1 &lt;-<span class="st"> </span>sigma2 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb28-6"><a href="#cb28-6"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, mu1, sigma1)</span>
<span id="cb28-7"><a href="#cb28-7"></a>y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(m, mu2, sigma2)</span>
<span id="cb28-8"><a href="#cb28-8"></a><span class="kw">maxout</span>(x, y, <span class="dv">500</span>)</span>
<span id="cb28-9"><a href="#cb28-9"></a><span class="co">#&gt; $estimate</span></span>
<span id="cb28-10"><a href="#cb28-10"></a><span class="co">#&gt; [1] 4</span></span>
<span id="cb28-11"><a href="#cb28-11"></a><span class="co">#&gt; </span></span>
<span id="cb28-12"><a href="#cb28-12"></a><span class="co">#&gt; $p.val</span></span>
<span id="cb28-13"><a href="#cb28-13"></a><span class="co">#&gt; [1] 0.5528942</span></span></code></pre></div>
<p>In the second example, suppose that the variances of two populations are unequal, where <span class="math inline">\(\sigma_1^2=1, \sigma_2^2=4\)</span>. The sample sizes are <span class="math inline">\(n=30, m=60\)</span> respectively. Do 500 replicates in this test. The p-value of this test is 0.002, so the observed statistic is significant.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>sigma1 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb29-2"><a href="#cb29-2"></a>sigma2 &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb29-3"><a href="#cb29-3"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, mu1, sigma1)</span>
<span id="cb29-4"><a href="#cb29-4"></a>y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(m, mu2, sigma2)</span>
<span id="cb29-5"><a href="#cb29-5"></a><span class="kw">maxout</span>(x, y, <span class="dv">500</span>)</span>
<span id="cb29-6"><a href="#cb29-6"></a><span class="co">#&gt; $estimate</span></span>
<span id="cb29-7"><a href="#cb29-7"></a><span class="co">#&gt; [1] 21</span></span>
<span id="cb29-8"><a href="#cb29-8"></a><span class="co">#&gt; </span></span>
<span id="cb29-9"><a href="#cb29-9"></a><span class="co">#&gt; $p.val</span></span>
<span id="cb29-10"><a href="#cb29-10"></a><span class="co">#&gt; [1] 0.001996008</span></span></code></pre></div>
</div>
</div>
<div id="homework-7" class="section level1">
<h1>Homework 7</h1>
<div id="b" class="section level2">
<h2>9.4b</h2>
<p>For Exercise 9.4a, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat{R} &lt; 1.2\)</span>.</p>
<p><span class="math inline">\(\textbf{Solution:}\)</span></p>
<p>From exercise 9.4a, we know that <span class="math inline">\(\sigma=1\)</span> and <span class="math inline">\(\sigma=2\)</span> can fit the target distribution well. In this exercise, let the length of the chain be <span class="math inline">\(N=1000\)</span>, the standard deviation of proposal distribution be <span class="math inline">\(\sigma=2\)</span>. Run 3 Markov Chains simultaneously. Use package <code>coda</code> to check the convergence of the chain.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="kw">set.seed</span>(<span class="dv">1117</span>)</span>
<span id="cb30-2"><a href="#cb30-2"></a></span>
<span id="cb30-3"><a href="#cb30-3"></a>m &lt;-<span class="st"> </span><span class="dv">3</span> <span class="co"># number of Markov chains</span></span>
<span id="cb30-4"><a href="#cb30-4"></a>N &lt;-<span class="st"> </span><span class="dv">1000</span> <span class="co"># the length of each chain</span></span>
<span id="cb30-5"><a href="#cb30-5"></a>sigma &lt;-<span class="st"> </span><span class="dv">2</span> <span class="co"># the standard deviation of proposal distribution</span></span>
<span id="cb30-6"><a href="#cb30-6"></a>X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span>m, <span class="dt">ncol=</span>N) <span class="co"># matrix for storing Markov chains</span></span>
<span id="cb30-7"><a href="#cb30-7"></a>x0 &lt;-<span class="st"> </span><span class="dv">2</span> <span class="co"># initial value for the chains</span></span>
<span id="cb30-8"><a href="#cb30-8"></a></span>
<span id="cb30-9"><a href="#cb30-9"></a>rw.Metropolis &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, x0, N){</span>
<span id="cb30-10"><a href="#cb30-10"></a>  <span class="co"># sigma is the standard deviation of proposal distribution N(X_t, \sigma^2)</span></span>
<span id="cb30-11"><a href="#cb30-11"></a>  <span class="co"># x0 is the starting point when implementing sampling</span></span>
<span id="cb30-12"><a href="#cb30-12"></a>  <span class="co"># N is the length of the chain</span></span>
<span id="cb30-13"><a href="#cb30-13"></a>  </span>
<span id="cb30-14"><a href="#cb30-14"></a>  x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb30-15"><a href="#cb30-15"></a>  x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</span>
<span id="cb30-16"><a href="#cb30-16"></a>  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb30-17"><a href="#cb30-17"></a>  k &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb30-18"><a href="#cb30-18"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N){</span>
<span id="cb30-19"><a href="#cb30-19"></a>    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i <span class="op">-</span><span class="st"> </span><span class="dv">1</span>], sigma)</span>
<span id="cb30-20"><a href="#cb30-20"></a>    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span><span class="kw">exp</span>(<span class="kw">abs</span>(x[i <span class="op">-</span><span class="st"> </span><span class="dv">1</span>]) <span class="op">-</span><span class="st"> </span><span class="kw">abs</span>(y))){</span>
<span id="cb30-21"><a href="#cb30-21"></a>      x[i] &lt;-<span class="st"> </span>y</span>
<span id="cb30-22"><a href="#cb30-22"></a>    }<span class="cf">else</span>{</span>
<span id="cb30-23"><a href="#cb30-23"></a>      x[i] &lt;-<span class="st"> </span>x[i <span class="op">-</span><span class="st"> </span><span class="dv">1</span>]</span>
<span id="cb30-24"><a href="#cb30-24"></a>    }</span>
<span id="cb30-25"><a href="#cb30-25"></a>  }</span>
<span id="cb30-26"><a href="#cb30-26"></a>  </span>
<span id="cb30-27"><a href="#cb30-27"></a>  <span class="kw">return</span> (x)</span>
<span id="cb30-28"><a href="#cb30-28"></a>}</span>
<span id="cb30-29"><a href="#cb30-29"></a></span>
<span id="cb30-30"><a href="#cb30-30"></a></span>
<span id="cb30-31"><a href="#cb30-31"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb30-32"><a href="#cb30-32"></a>  X[j, ] &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma, x0, N)</span>
<span id="cb30-33"><a href="#cb30-33"></a>}</span>
<span id="cb30-34"><a href="#cb30-34"></a></span>
<span id="cb30-35"><a href="#cb30-35"></a><span class="kw">library</span>(coda)</span>
<span id="cb30-36"><a href="#cb30-36"></a>X1 &lt;-<span class="st"> </span><span class="kw">as.mcmc</span>(X[<span class="dv">1</span>, ])</span>
<span id="cb30-37"><a href="#cb30-37"></a>X2 &lt;-<span class="st"> </span><span class="kw">as.mcmc</span>(X[<span class="dv">2</span>, ])</span>
<span id="cb30-38"><a href="#cb30-38"></a>X3 &lt;-<span class="st"> </span><span class="kw">as.mcmc</span>(X[<span class="dv">3</span>, ])</span>
<span id="cb30-39"><a href="#cb30-39"></a>Y &lt;-<span class="st"> </span><span class="kw">mcmc.list</span>(X1, X2, X3)</span>
<span id="cb30-40"><a href="#cb30-40"></a><span class="kw">print</span>(<span class="kw">gelman.diag</span>(Y))</span>
<span id="cb30-41"><a href="#cb30-41"></a><span class="co">#&gt; Potential scale reduction factors:</span></span>
<span id="cb30-42"><a href="#cb30-42"></a><span class="co">#&gt; </span></span>
<span id="cb30-43"><a href="#cb30-43"></a><span class="co">#&gt;      Point est. Upper C.I.</span></span>
<span id="cb30-44"><a href="#cb30-44"></a><span class="co">#&gt; [1,]       1.03       1.03</span></span>
<span id="cb30-45"><a href="#cb30-45"></a><span class="kw">gelman.plot</span>(Y, <span class="dt">col=</span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAbFBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6OpA6kNtmAABmADpmkJBmtrZmtv+QOgCQOjqQOmaQkGaQkNuQ2/+2ZgC225C2/7a2///bkDrb2//b/7bb////AAD/tmb/25D//7b//9v////rd6YKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAALSUlEQVR4nO2dC3erNhaFdVNn2rHv1Jl2QhtmLsTm///H0Zun2CCQrXD3XisORkKCz4ejBwcQDTUr8ewdyF0EBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBAOwMSX0bPArRvcelEQEAEBJQXoGrfSvYQAQERENCDAYHWk4BSFZdOeQGiBYHiCAgU9/MAKl4+ms9XIb69ryruEIDub2eYWfP5h4Rzu1zX1HsIQMFjbnW7SIbFSS2Wv/xYUe8hADW1NI95KYbW0EKZDwzodrFdvRlOynrKCAvKUGmc9O3y8qFNqA556UBx+ZlQqma+NlZ2WlncMQCp9jvcgG+ot3osIGneuMWJcdJCud9SwMZsdb2PB4QzxfeDQu63r3JNK3YMQM4qcWs/VcrsdEcCPJ+vv8tW96y8gtrtUtasf1+58O1Pd4oVQqfeLirv4MRIbUGwuK6SAJJmUqouibLlUn75fD2brn4tLCDdKZEpt4vKOzCrrHzQ4o2XX8fSOOzHVffwlenLZblQGEC37+861QwATFLEjj6iFUtgQ/p43YdxOmpBu4dOK1arU0t/GbZreU13pAZkjexa9gBJf/Ty1+tugLRFNrNO2o9GwgOSR7ViExbUuH23gHyWnQGFGnCl+xtq4p4CyB+8cTSlAaRp1XudYkVrG3PTQve34CBjpt7UgEwTVdi2yrVixnjk4exsQfOqQSP3uGa+C0j3g7Rxd/tBavndNml5O+n8hqpxgArZRaxn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" /><!-- --></p>
<p>It can be seen that for iterations=1000, the Gelman-Rubin statistic is 1.03. From the Gelman-Rubin plot, the chains converge to the target distribution after about 300 iterations.</p>
</div>
</div>
<div id="homework-8" class="section level1">
<h1>Homework 8</h1>
<div id="a-b-o-blood-type-problem" class="section level2">
<h2>A-B-O blood type problem</h2>
<ol style="list-style-type: decimal">
<li><p>Use EM algorithm to solve MLE of <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span>.</p></li>
<li><p>Record the values of <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> that maximize the conditional likelihood in each EM steps, calculate the corresponding log-maximum likelihood values(for observed data), are they increasing?</p></li>
</ol>
<p><span class="math inline">\(\textbf{Solution:}\)</span></p>
<ol style="list-style-type: decimal">
<li>Note that <span class="math inline">\(n_{AA}\)</span> and <span class="math inline">\(n_{BB}\)</span> are missing, and the constraint <span class="math inline">\(p+q+r=1\)</span> holds, the complete data likelihood can be written as <span class="math display">\[
\begin{aligned}
L_c(p, q) &amp;= (p^2)^{n_{AA}}(q^2)^{n_{BB}}(r^2)^{n_{OO}}(2pr)^{n_{AO}}(2qr)^{n_{BO}}(2pq)^{n_{AB}} \\
      &amp;= (p^2)^{n_{A\cdot} - n_{AO}}(q^2)^{n_{B \cdot} - n_{BO}} (r^2)^{n_{OO}}(2pr)^{n_{AO}}(2qr)^{n_{BO}}(2pq)^{n_{AB}} \\
      &amp;= (p^2)^{n_{A \cdot}} (\frac{2r}{p})^{n_{AO}} (q^2)^{n_{B \cdot}} (\frac{2r}{q})^{n_{BO}} (r^2)^{n_{OO}} (2pq)^{n_{AB}} \\
      &amp; \propto (p^2)^{n_{A \cdot}} (\frac{r}{p})^{n_{AO}} (q^2)^{n_{B \cdot}} (\frac{r}{q})^{n_{BO}} (r^2)^{n_{OO}} (pq)^{n_{AB}}.
\end{aligned}
\]</span> The log likelihood of <span class="math inline">\(L_c(p, q)\)</span> is <span class="math display">\[
\ell_c(p,q) = 2n_{A \cdot} \ln p + n_{AO} \ln(r/p) + 2n_{B \cdot} \ln q + n_{BO} \ln(r/q) + 2n_{OO} \ln r + n_{AB} \ln(pq).
\]</span></li>
</ol>
<p>Given an initial estimate of <span class="math inline">\(p, q\)</span>, named <span class="math inline">\(\hat{p}_{0}, \hat{q}_{0}\)</span>, the E-step can be written as <span class="math display">\[
\begin{aligned}
&amp; E_{\hat{p}_0, \hat{q}_0}[\ell_c(p,q)|n_{A \cdot}, n_{B \cdot}, n_{OO}, n_{AB}] \\ 
&amp;=  2n_{A \cdot} \ln p + 2n_{B \cdot} \ln q + 2n_{OO} \ln r + n_{AB} \ln(pq) \\ 
&amp;+ E_{\hat{p}_0, \hat{q}_0}[n_{AO} \ln(r/p)|n_{A \cdot}, n_{B \cdot}, n_{OO}, n_{AB}] + E_{\hat{p}_0, \hat{q}_0}[n_{BO} \ln(r/q)|n_{A \cdot}, n_{B \cdot}, n_{OO}, n_{AB}] \\
&amp;= 2n_{A \cdot} \ln p + 2n_{B \cdot} \ln q + 2n_{OO} \ln r + n_{AB} \ln(pq) \\
+ &amp;n_{A \cdot} \frac{2\hat{p}_0(1-\hat{p}_0 - \hat{q}_0)}{2\hat{p}_0(1-\hat{p}_0 - \hat{q}_0) + \hat{p}_0^2} \ln (r/p) + n_{B \cdot}\frac{2\hat{q}_0(1-\hat{p}_0 - \hat{q}_0)}{2\hat{q}_0(1-\hat{p}_0 - \hat{q}_0) + \hat{q}_0^2} \ln(r/q),
\end{aligned}
\]</span> this is due to the fact that <span class="math inline">\(n_{AO} | n_{A \cdot}, n_{B \cdot}, n_{OO}, n_{AB} \sim B(n_{A \cdot}, \frac{2pr}{2pr + p^2}), n_{BO} | n_{A \cdot}, n_{B \cdot}, n_{OO}, n_{AB} \sim B(n_{B \cdot}, \frac{2qr}{2qr + q^2}).\)</span></p>
<p>In M-step, take partial derivatives of <span class="math inline">\(Q=E_{\hat{p}_0, \hat{q}_0}[\ell_c(p,q)|n_{A \cdot}, n_{B \cdot}, n_{OO}, n_{AB}]\)</span> with respect to <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span>. Let <span class="math inline">\(\alpha=n_{A \cdot} \frac{2\hat{p}_0(1-\hat{p}_0 - \hat{q}_0)}{2\hat{p}_0(1-\hat{p}_0 - \hat{q}_0) + \hat{p}_0^2}, \beta=n_{B \cdot}\frac{2\hat{q}_0(1-\hat{p}_0 - \hat{q}_0)}{2\hat{q}_0(1-\hat{p}_0 - \hat{q}_0) + \hat{q}_0^2},\)</span> then <span class="math display">\[
\begin{aligned}
\frac{\partial Q}{\partial p} &amp;= \frac{2n_{A \cdot}}{p} - \frac{2n_{OO}}{1-p-q} + n_{AB} \frac{q}{pq} + \alpha \frac{\frac{(q-1)}{p^2}}{\frac{(1-p-q)}{p}} + \beta \frac{\frac{-1}{q}}{\frac{(1-p-q)}{q}} \\
&amp;= \frac{2n_{A \cdot}}{p} - \frac{2n_{OO}}{1-p-q} + \frac{n_{AB}}{p} + \alpha \frac{q-1}{p(1-p-q)} - \beta \frac{1}{1-p-q}.
\end{aligned}
\]</span> <span class="math display">\[
\begin{aligned}
\frac{\partial Q}{\partial q} &amp;= \frac{2n_{B \cdot}}{q} - \frac{2n_{OO}}{1-p-q} + n_{AB} \frac{p}{pq} + \alpha \frac{\frac{-1}{p}}{\frac{(1-p-q)}{p}} + \beta \frac{\frac{(p-1)}{q^2}}{\frac{(1-p-q)}{q}} \\
&amp;= \frac{2n_{B \cdot}}{q} - \frac{2n_{OO}}{1-p-q} + \frac{n_{AB}}{q} - \alpha \frac{1}{1-p-q} + \beta \frac{p-1}{q(1-p-q)}.
\end{aligned}
\]</span></p>
<p>Let <span class="math inline">\(\frac{\partial Q}{\partial p}=0\)</span> and <span class="math inline">\(\frac{\partial Q}{\partial q}=0\)</span>, and after some simplification, we can get <span class="math display">\[
\begin{aligned}
(2n_{A \cdot} + n_{AB} + 2n_{OO} + \beta)p + (2n_{A \cdot} + n_{AB} - \alpha)q &amp;= -\alpha + 2n_{A \cdot} + n_{AB}, \\
(2n_{B \cdot} + n_{AB} - \beta)p + (2n_{B \cdot} + n_{AB} + 2n_{OO} + \alpha)q &amp;= -\beta + 2n_{B \cdot} + n_{AB}.
\end{aligned}
\]</span></p>
<p>By solving the linear equation system, we have <span class="math display">\[
\begin{aligned}
p &amp;= \frac{\begin{vmatrix}
-\alpha + 2n_{A \cdot} + n_{AB} &amp; 2n_{A \cdot} + n_{AB} - \alpha \\ 
-\beta + 2n_{B \cdot} + n_{AB} &amp; 2n_{B \cdot} + n_{AB} + 2n_{OO} + \alpha
\end{vmatrix}}{\begin{vmatrix}
2n_{A \cdot} + n_{AB} + 2n_{OO} + \beta &amp; 2n_{A \cdot} + n_{AB} - \alpha \\ 
2n_{B \cdot} + n_{AB} - \beta &amp; 2n_{B \cdot} + n_{AB} + 2n_{OO} + \alpha
\end{vmatrix}}, \\
q &amp;= \frac{\begin{vmatrix}
2n_{A \cdot} + n_{AB} + 2n_{OO} + \beta &amp; -\alpha + 2n_{A \cdot} + n_{AB}\\ 
2n_{B \cdot} + n_{AB} - \beta &amp; -\beta + 2n_{B \cdot} + n_{AB}
\end{vmatrix}}{\begin{vmatrix}
2n_{A \cdot} + n_{AB} + 2n_{OO} + \beta &amp; 2n_{A \cdot} + n_{AB} - \alpha \\ 
2n_{B \cdot} + n_{AB} - \beta &amp; 2n_{B \cdot} + n_{AB} + 2n_{OO} + \alpha
\end{vmatrix}}
\end{aligned}
\]</span></p>
<p>From the observed data, we can get the MLE of <span class="math inline">\(r\)</span>, <span class="math inline">\(\hat{r}=\sqrt{\frac{n_{OO}}{n}}.\)</span> Since <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> satisfy <span class="math display">\[
\begin{aligned}
p^2 + 2pr = \frac{n_{A\cdot}}{n}, \\
q^2 + 2qr = \frac{n_{B \cdot}}{n}.
\end{aligned}
\]</span> we can give an intuitive initial value of <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> <span class="math display">\[
\begin{aligned}
\hat{p}_{0} = \frac{-2\hat{r} + \sqrt{(2\hat{r})^2 + 4\frac{n_{A \cdot}}{n}}}{2}  \\
\hat{q}_{0} = \frac{-2\hat{r} + \sqrt{(2\hat{r})^2 + 4\frac{n_{B \cdot}}{n}}}{2}.
\end{aligned}
\]</span></p>
<ol start="2" style="list-style-type: decimal">
<li>The conditional log likelihood for observed data is <span class="math display">\[
\ell_O(p, q) = n_{A\cdot}\log(p^2 + 2pr) + n_{B\cdot}\log(q^2 + 2qr)+ n_{OO}\log(r^2)+ n_{AB}\log(2pq).
\]</span> Substitute <span class="math inline">\(p\)</span>, <span class="math inline">\(q\)</span> and <span class="math inline">\(r\)</span> with <span class="math inline">\(\hat{p}\)</span>, <span class="math inline">\(\hat{q}\)</span> and <span class="math inline">\(1 - \hat{p} - \hat{q}\)</span> to compute the log likelihood.</li>
</ol>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>nAdot &lt;-<span class="st"> </span><span class="dv">444</span></span>
<span id="cb31-2"><a href="#cb31-2"></a>nBdot &lt;-<span class="st"> </span><span class="dv">132</span></span>
<span id="cb31-3"><a href="#cb31-3"></a>nOO &lt;-<span class="st"> </span><span class="dv">361</span></span>
<span id="cb31-4"><a href="#cb31-4"></a>nAB &lt;-<span class="st"> </span><span class="dv">63</span></span>
<span id="cb31-5"><a href="#cb31-5"></a>n &lt;-<span class="st"> </span>nAdot <span class="op">+</span><span class="st"> </span>nBdot <span class="op">+</span><span class="st"> </span>nOO <span class="op">+</span><span class="st"> </span>nAB</span>
<span id="cb31-6"><a href="#cb31-6"></a>rhat &lt;-<span class="st"> </span><span class="kw">sqrt</span>(nOO <span class="op">/</span><span class="st"> </span>n)</span>
<span id="cb31-7"><a href="#cb31-7"></a>c1 &lt;-<span class="st"> </span>nAdot <span class="op">/</span><span class="st"> </span>n</span>
<span id="cb31-8"><a href="#cb31-8"></a>c2 &lt;-<span class="st"> </span>nBdot <span class="op">/</span><span class="st"> </span>n</span>
<span id="cb31-9"><a href="#cb31-9"></a>phat &lt;-<span class="st"> </span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>rhat <span class="op">+</span><span class="st"> </span><span class="kw">sqrt</span>((<span class="dv">2</span><span class="op">*</span>rhat)<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">4</span><span class="op">*</span><span class="dv">1</span><span class="op">*</span>c1)) <span class="op">/</span><span class="st"> </span><span class="dv">2</span></span>
<span id="cb31-10"><a href="#cb31-10"></a>qhat &lt;-<span class="st"> </span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>rhat <span class="op">+</span><span class="st"> </span><span class="kw">sqrt</span>((<span class="dv">2</span><span class="op">*</span>rhat)<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">4</span><span class="op">*</span><span class="dv">1</span><span class="op">*</span>c2)) <span class="op">/</span><span class="st"> </span><span class="dv">2</span></span>
<span id="cb31-11"><a href="#cb31-11"></a></span>
<span id="cb31-12"><a href="#cb31-12"></a>max.iters &lt;-<span class="st"> </span><span class="dv">20</span><span class="co"># maximum iterations</span></span>
<span id="cb31-13"><a href="#cb31-13"></a>p &lt;-<span class="st"> </span>phat; q &lt;-<span class="st"> </span>qhat <span class="co"># initial value of p and q</span></span>
<span id="cb31-14"><a href="#cb31-14"></a>result &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, max.iters, <span class="dv">3</span>)</span>
<span id="cb31-15"><a href="#cb31-15"></a></span>
<span id="cb31-16"><a href="#cb31-16"></a></span>
<span id="cb31-17"><a href="#cb31-17"></a><span class="cf">for</span> (iter <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>max.iters){</span>
<span id="cb31-18"><a href="#cb31-18"></a>  </span>
<span id="cb31-19"><a href="#cb31-19"></a>  alpha &lt;-<span class="st"> </span>(nAdot <span class="op">*</span><span class="st"> </span>(<span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p<span class="op">-</span>q))) <span class="op">/</span><span class="st"> </span>(<span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p<span class="op">-</span>q) <span class="op">+</span><span class="st"> </span>p<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb31-20"><a href="#cb31-20"></a>  beta &lt;-<span class="st"> </span>(nBdot <span class="op">*</span><span class="st"> </span>(<span class="dv">2</span><span class="op">*</span>q<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p<span class="op">-</span>q))) <span class="op">/</span><span class="st"> </span>(<span class="dv">2</span><span class="op">*</span>q<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p<span class="op">-</span>q) <span class="op">+</span><span class="st"> </span>q<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb31-21"><a href="#cb31-21"></a>  </span>
<span id="cb31-22"><a href="#cb31-22"></a>  nump &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(</span>
<span id="cb31-23"><a href="#cb31-23"></a>    <span class="op">-</span>alpha <span class="op">+</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>nAdot <span class="op">+</span><span class="st"> </span>nAB,</span>
<span id="cb31-24"><a href="#cb31-24"></a>    <span class="dv">2</span> <span class="op">*</span><span class="st"> </span>nAdot <span class="op">+</span><span class="st"> </span>nAB <span class="op">-</span><span class="st"> </span>alpha,</span>
<span id="cb31-25"><a href="#cb31-25"></a>    <span class="op">-</span>beta <span class="op">+</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>nBdot <span class="op">+</span><span class="st"> </span>nAB,</span>
<span id="cb31-26"><a href="#cb31-26"></a>    <span class="dv">2</span> <span class="op">*</span><span class="st"> </span>nBdot <span class="op">+</span><span class="st"> </span>nAB <span class="op">+</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span>nOO <span class="op">+</span><span class="st"> </span>alpha</span>
<span id="cb31-27"><a href="#cb31-27"></a>  ), <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)</span>
<span id="cb31-28"><a href="#cb31-28"></a>  </span>
<span id="cb31-29"><a href="#cb31-29"></a>  numq &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(</span>
<span id="cb31-30"><a href="#cb31-30"></a>    <span class="dv">2</span> <span class="op">*</span><span class="st"> </span>nAdot <span class="op">+</span><span class="st"> </span>nAB <span class="op">+</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>nOO <span class="op">+</span><span class="st"> </span>beta,</span>
<span id="cb31-31"><a href="#cb31-31"></a>    <span class="op">-</span>alpha <span class="op">+</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>nAdot <span class="op">+</span><span class="st"> </span>nAB,</span>
<span id="cb31-32"><a href="#cb31-32"></a>    <span class="dv">2</span> <span class="op">*</span><span class="st"> </span>nBdot <span class="op">+</span><span class="st"> </span>nAB <span class="op">-</span><span class="st"> </span>beta,</span>
<span id="cb31-33"><a href="#cb31-33"></a>    <span class="op">-</span>beta <span class="op">+</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>nBdot <span class="op">+</span><span class="st"> </span>nAB</span>
<span id="cb31-34"><a href="#cb31-34"></a>  ), <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)</span>
<span id="cb31-35"><a href="#cb31-35"></a>  </span>
<span id="cb31-36"><a href="#cb31-36"></a>  denom &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(</span>
<span id="cb31-37"><a href="#cb31-37"></a>    <span class="dv">2</span> <span class="op">*</span><span class="st"> </span>nAdot <span class="op">+</span><span class="st"> </span>nAB <span class="op">+</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>nOO <span class="op">+</span><span class="st"> </span>beta,</span>
<span id="cb31-38"><a href="#cb31-38"></a>    <span class="dv">2</span> <span class="op">*</span><span class="st"> </span>nAdot <span class="op">+</span><span class="st"> </span>nAB <span class="op">-</span><span class="st"> </span>alpha,</span>
<span id="cb31-39"><a href="#cb31-39"></a>    <span class="dv">2</span> <span class="op">*</span><span class="st"> </span>nBdot <span class="op">+</span><span class="st"> </span>nAB <span class="op">-</span><span class="st"> </span>beta,</span>
<span id="cb31-40"><a href="#cb31-40"></a>    <span class="dv">2</span> <span class="op">*</span><span class="st"> </span>nBdot <span class="op">+</span><span class="st"> </span>nAB <span class="op">+</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>nOO <span class="op">+</span><span class="st"> </span>alpha</span>
<span id="cb31-41"><a href="#cb31-41"></a>  ), <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)</span>
<span id="cb31-42"><a href="#cb31-42"></a>  </span>
<span id="cb31-43"><a href="#cb31-43"></a>  p &lt;-<span class="st"> </span><span class="kw">det</span>(nump) <span class="op">/</span><span class="st"> </span><span class="kw">det</span>(denom)</span>
<span id="cb31-44"><a href="#cb31-44"></a>  q &lt;-<span class="st"> </span><span class="kw">det</span>(numq) <span class="op">/</span><span class="st"> </span><span class="kw">det</span>(denom)</span>
<span id="cb31-45"><a href="#cb31-45"></a>  r &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>p <span class="op">-</span><span class="st"> </span>q</span>
<span id="cb31-46"><a href="#cb31-46"></a>  loglik &lt;-<span class="st"> </span>nAdot<span class="op">*</span><span class="kw">log</span>(p<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>r) <span class="op">+</span><span class="st"> </span>nBdot<span class="op">*</span><span class="kw">log</span>(q<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span>q<span class="op">*</span>r) <span class="op">+</span></span>
<span id="cb31-47"><a href="#cb31-47"></a><span class="st">    </span>nOO<span class="op">*</span><span class="kw">log</span>(r<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>nAB<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>q)</span>
<span id="cb31-48"><a href="#cb31-48"></a>  </span>
<span id="cb31-49"><a href="#cb31-49"></a>  result[iter, <span class="dv">1</span>] &lt;-<span class="st"> </span>p</span>
<span id="cb31-50"><a href="#cb31-50"></a>  result[iter, <span class="dv">2</span>] &lt;-<span class="st"> </span>q</span>
<span id="cb31-51"><a href="#cb31-51"></a>  result[iter, <span class="dv">3</span>] &lt;-<span class="st"> </span>loglik</span>
<span id="cb31-52"><a href="#cb31-52"></a>}</span>
<span id="cb31-53"><a href="#cb31-53"></a></span>
<span id="cb31-54"><a href="#cb31-54"></a><span class="kw">cat</span>(<span class="st">&quot;The MLEs of p and q using EM algorithm are &quot;</span>, p, <span class="st">&quot; and &quot;</span>, q)</span>
<span id="cb31-55"><a href="#cb31-55"></a><span class="co">#&gt; The MLEs of p and q using EM algorithm are  0.2976407  and  0.1027063</span></span></code></pre></div>
<p>Let’s go through the change of log likelihood for observed data. We can see that the log likelihood increases within first 3 iterations and seems unchanged after the 4th iteration. It shows that the EM algorithm converges very quickly.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="kw">data.frame</span>(<span class="dt">p=</span>result[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dv">1</span>], <span class="dt">q=</span>result[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dv">2</span>], <span class="dt">loglik=</span>result[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dv">3</span>])</span>
<span id="cb32-2"><a href="#cb32-2"></a><span class="co">#&gt;            p         q    loglik</span></span>
<span id="cb32-3"><a href="#cb32-3"></a><span class="co">#&gt; 1  0.2973357 0.1026199 -1169.822</span></span>
<span id="cb32-4"><a href="#cb32-4"></a><span class="co">#&gt; 2  0.2975814 0.1026991 -1169.822</span></span>
<span id="cb32-5"><a href="#cb32-5"></a><span class="co">#&gt; 3  0.2976297 0.1027054 -1169.822</span></span>
<span id="cb32-6"><a href="#cb32-6"></a><span class="co">#&gt; 4  0.2976387 0.1027061 -1169.822</span></span>
<span id="cb32-7"><a href="#cb32-7"></a><span class="co">#&gt; 5  0.2976403 0.1027062 -1169.822</span></span>
<span id="cb32-8"><a href="#cb32-8"></a><span class="co">#&gt; 6  0.2976406 0.1027063 -1169.822</span></span>
<span id="cb32-9"><a href="#cb32-9"></a><span class="co">#&gt; 7  0.2976407 0.1027063 -1169.822</span></span>
<span id="cb32-10"><a href="#cb32-10"></a><span class="co">#&gt; 8  0.2976407 0.1027063 -1169.822</span></span>
<span id="cb32-11"><a href="#cb32-11"></a><span class="co">#&gt; 9  0.2976407 0.1027063 -1169.822</span></span>
<span id="cb32-12"><a href="#cb32-12"></a><span class="co">#&gt; 10 0.2976407 0.1027063 -1169.822</span></span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="kw">plot</span>(result[, <span class="dv">3</span>][<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>], <span class="dt">pch=</span><span class="dv">16</span>, </span>
<span id="cb33-2"><a href="#cb33-2"></a>     <span class="dt">main=</span><span class="st">&quot;Log likelihood vs. iterations&quot;</span>, </span>
<span id="cb33-3"><a href="#cb33-3"></a>     <span class="dt">xlab=</span><span class="st">&quot;Number of iterations&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Log likelihood&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="exercise-3-page-204" class="section level2">
<h2>Exercise 3, Page 204</h2>
<p>Use both for loops and <code>lapply()</code> to fit linear models to the <code>mtcars</code> using the formulas stored in this list:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a>formulas &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb34-2"><a href="#cb34-2"></a>  mpg <span class="op">~</span><span class="st"> </span>disp,</span>
<span id="cb34-3"><a href="#cb34-3"></a>  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</span>
<span id="cb34-4"><a href="#cb34-4"></a>  mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</span>
<span id="cb34-5"><a href="#cb34-5"></a>  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</span>
<span id="cb34-6"><a href="#cb34-6"></a>)</span></code></pre></div>
<p><span class="math inline">\(\textbf{Solution:}\)</span></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a>formulas &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb35-2"><a href="#cb35-2"></a>  mpg <span class="op">~</span><span class="st"> </span>disp,</span>
<span id="cb35-3"><a href="#cb35-3"></a>  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</span>
<span id="cb35-4"><a href="#cb35-4"></a>  mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</span>
<span id="cb35-5"><a href="#cb35-5"></a>  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</span>
<span id="cb35-6"><a href="#cb35-6"></a>)</span>
<span id="cb35-7"><a href="#cb35-7"></a></span>
<span id="cb35-8"><a href="#cb35-8"></a><span class="co"># fit linear models using for loops</span></span>
<span id="cb35-9"><a href="#cb35-9"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>){</span>
<span id="cb35-10"><a href="#cb35-10"></a>  model &lt;-<span class="st"> </span><span class="kw">lm</span>(formulas[[i]], <span class="dt">data=</span>mtcars)</span>
<span id="cb35-11"><a href="#cb35-11"></a>}</span>
<span id="cb35-12"><a href="#cb35-12"></a></span>
<span id="cb35-13"><a href="#cb35-13"></a><span class="co"># fit linear models using lapply()</span></span>
<span id="cb35-14"><a href="#cb35-14"></a><span class="kw">lapply</span>(formulas, <span class="cf">function</span>(formula) <span class="kw">lm</span>(formula, <span class="dt">data=</span>mtcars))</span></code></pre></div>
</div>
<div id="exercise-3-page-213" class="section level2">
<h2>Exercise 3, Page 213</h2>
<p>The following code simulates the performance of a t-test for non-normal data. Use <code>sapply()</code> and an anonymous function to extract the p-value from every trial.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a>trials &lt;-<span class="st"> </span><span class="kw">replicate</span>(</span>
<span id="cb36-2"><a href="#cb36-2"></a>  <span class="dv">100</span>,</span>
<span id="cb36-3"><a href="#cb36-3"></a>  <span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb36-4"><a href="#cb36-4"></a>  <span class="dt">simplify =</span> <span class="ot">FALSE</span></span>
<span id="cb36-5"><a href="#cb36-5"></a>)</span></code></pre></div>
<p><span class="math inline">\(\textbf{Solution:}\)</span></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>trials &lt;-<span class="st"> </span><span class="kw">replicate</span>(</span>
<span id="cb37-2"><a href="#cb37-2"></a>  <span class="dv">100</span>,</span>
<span id="cb37-3"><a href="#cb37-3"></a>  <span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb37-4"><a href="#cb37-4"></a>  <span class="dt">simplify =</span> <span class="ot">FALSE</span></span>
<span id="cb37-5"><a href="#cb37-5"></a>)</span>
<span id="cb37-6"><a href="#cb37-6"></a></span>
<span id="cb37-7"><a href="#cb37-7"></a><span class="co"># extract the p-value using sapply()</span></span>
<span id="cb37-8"><a href="#cb37-8"></a><span class="co"># using anonymous function</span></span>
<span id="cb37-9"><a href="#cb37-9"></a>p.val.ano &lt;-<span class="st"> </span><span class="kw">sapply</span>(trials, <span class="cf">function</span>(x) x<span class="op">$</span>p.value)</span>
<span id="cb37-10"><a href="#cb37-10"></a><span class="co"># using [[</span></span>
<span id="cb37-11"><a href="#cb37-11"></a>p.val &lt;-<span class="st"> </span><span class="kw">sapply</span>(trials, <span class="st">&quot;[[&quot;</span>, <span class="st">&quot;p.value&quot;</span>)</span>
<span id="cb37-12"><a href="#cb37-12"></a></span>
<span id="cb37-13"><a href="#cb37-13"></a><span class="co"># check if `p.val.ano` and `p.val` are identical</span></span>
<span id="cb37-14"><a href="#cb37-14"></a><span class="kw">all</span>(p.val.ano <span class="op">==</span><span class="st"> </span>p.val)</span>
<span id="cb37-15"><a href="#cb37-15"></a><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
</div>
<div id="exercise-6-page-214" class="section level2">
<h2>Exercise 6, Page 214</h2>
<p>Implement a combination of <code>Map()</code> and <code>vapply()</code> to create an <code>lapply()</code> variant that iterates in parallel over all of its inputs and stores its outputs in a vector(or a matrix). What arguments should the function take?</p>
<p><span class="math inline">\(\textbf{Solution:}\)</span></p>
<p>The function <code>mylapply</code> iterates over the list X, whose elements are all lists(data frames), and do the same operation for all of its elements. The function takes four arguments, <code>X</code> is the input data, <code>FUN</code> is the operation to impose on the input, <code>FUN.VALUE</code> is the same meaning as <code>vapply()</code> and <code>simplify</code> is the indicator to use function <code>simplify2array()</code>.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a>mylapply &lt;-<span class="st"> </span><span class="cf">function</span>(X, FUN, FUN.VALUE, <span class="dt">simplify =</span> <span class="ot">TRUE</span>){</span>
<span id="cb38-2"><a href="#cb38-2"></a>  val &lt;-<span class="st"> </span><span class="kw">Map</span>(<span class="cf">function</span>(x) <span class="kw">vapply</span>(x, FUN, FUN.VALUE), X)</span>
<span id="cb38-3"><a href="#cb38-3"></a>  <span class="cf">if</span> (simplify){</span>
<span id="cb38-4"><a href="#cb38-4"></a>    <span class="kw">return</span> (<span class="kw">simplify2array</span>(val))</span>
<span id="cb38-5"><a href="#cb38-5"></a>  }</span>
<span id="cb38-6"><a href="#cb38-6"></a>  <span class="kw">return</span> (val)</span>
<span id="cb38-7"><a href="#cb38-7"></a>}</span></code></pre></div>
<p>Here is a test example.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a>ls &lt;-<span class="st"> </span><span class="kw">list</span>(mtcars, iris)</span>
<span id="cb39-2"><a href="#cb39-2"></a><span class="kw">mylapply</span>(ls, mean, <span class="kw">numeric</span>(<span class="dv">1</span>))</span>
<span id="cb39-3"><a href="#cb39-3"></a><span class="co">#&gt; Warning in mean.default(X[[i]], ...): 参数不是数值也不是逻辑值：回覆NA</span></span>
<span id="cb39-4"><a href="#cb39-4"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb39-5"><a href="#cb39-5"></a><span class="co">#&gt;        mpg        cyl       disp         hp       drat         wt       qsec </span></span>
<span id="cb39-6"><a href="#cb39-6"></a><span class="co">#&gt;  20.090625   6.187500 230.721875 146.687500   3.596563   3.217250  17.848750 </span></span>
<span id="cb39-7"><a href="#cb39-7"></a><span class="co">#&gt;         vs         am       gear       carb </span></span>
<span id="cb39-8"><a href="#cb39-8"></a><span class="co">#&gt;   0.437500   0.406250   3.687500   2.812500 </span></span>
<span id="cb39-9"><a href="#cb39-9"></a><span class="co">#&gt; </span></span>
<span id="cb39-10"><a href="#cb39-10"></a><span class="co">#&gt; [[2]]</span></span>
<span id="cb39-11"><a href="#cb39-11"></a><span class="co">#&gt; Sepal.Length  Sepal.Width Petal.Length  Petal.Width      Species </span></span>
<span id="cb39-12"><a href="#cb39-12"></a><span class="co">#&gt;     5.843333     3.057333     3.758000     1.199333           NA</span></span></code></pre></div>
</div>
</div>
<div id="homework-9" class="section level1">
<h1>Homework 9</h1>
<div id="section-18" class="section level2">
<h2>9.4</h2>
<p>Implement a random walk Metropolis sampler for generating the standard Laplace distribution. For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.</p>
<ul>
<li><p>Write an Rcpp function and Compare the corresponding generated random numbers with those by the R function you wrote before using the function “qqplot”.</p></li>
<li><p>Compare the computation time of the two functions with the function “microbenchmark”.</p></li>
<li><p>Comments your results.</p></li>
</ul>
<p><span class="math inline">\(\textbf{Solution:}\)</span></p>
<p>Suppose that <span class="math inline">\(X \sim Laplace(0, 1)\)</span>, if <span class="math inline">\(X\)</span> has density function <span class="math display">\[f(x)=\frac{1}{2}e^{-|x|}.\]</span> Now if we choose a normal distribution <span class="math inline">\(N(X_t, \sigma^2)\)</span> as proposal distribution, then we have <span class="math display">\[r(x_t, y)=\frac{f(y)}{f(x_t)}=\exp\left\{|x_t|-|y|\right\}.\]</span> The function <code>rw.Metropolis</code> is used for generating random numbers from standard Laplace distribution.</p>
<p>First show the <code>R</code> version of random walk Metropolis algorithm.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a>rw.Metropolis.r &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, x0, N){</span>
<span id="cb40-2"><a href="#cb40-2"></a>  <span class="co"># sigma is the standard deviation of proposal distribution N(X_t, \sigma^2)</span></span>
<span id="cb40-3"><a href="#cb40-3"></a>  <span class="co"># x0 is the starting point when implementing sampling</span></span>
<span id="cb40-4"><a href="#cb40-4"></a>  <span class="co"># N is the length of the chain</span></span>
<span id="cb40-5"><a href="#cb40-5"></a>  </span>
<span id="cb40-6"><a href="#cb40-6"></a>  x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb40-7"><a href="#cb40-7"></a>  x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</span>
<span id="cb40-8"><a href="#cb40-8"></a>  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb40-9"><a href="#cb40-9"></a>  k &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb40-10"><a href="#cb40-10"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N){</span>
<span id="cb40-11"><a href="#cb40-11"></a>    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i <span class="op">-</span><span class="st"> </span><span class="dv">1</span>], sigma)</span>
<span id="cb40-12"><a href="#cb40-12"></a>    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span><span class="kw">exp</span>(<span class="kw">abs</span>(x[i <span class="op">-</span><span class="st"> </span><span class="dv">1</span>]) <span class="op">-</span><span class="st"> </span><span class="kw">abs</span>(y))){</span>
<span id="cb40-13"><a href="#cb40-13"></a>      x[i] &lt;-<span class="st"> </span>y</span>
<span id="cb40-14"><a href="#cb40-14"></a>    }<span class="cf">else</span>{</span>
<span id="cb40-15"><a href="#cb40-15"></a>      x[i] &lt;-<span class="st"> </span>x[i <span class="op">-</span><span class="st"> </span><span class="dv">1</span>]</span>
<span id="cb40-16"><a href="#cb40-16"></a>      k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb40-17"><a href="#cb40-17"></a>    }</span>
<span id="cb40-18"><a href="#cb40-18"></a>  }</span>
<span id="cb40-19"><a href="#cb40-19"></a>  accept.rate &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>k <span class="op">/</span><span class="st"> </span>N</span>
<span id="cb40-20"><a href="#cb40-20"></a>  </span>
<span id="cb40-21"><a href="#cb40-21"></a>  <span class="kw">return</span> (<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">accept.rate=</span>accept.rate))</span>
<span id="cb40-22"><a href="#cb40-22"></a>}</span></code></pre></div>
<p>Next give the <code>C++</code> version of random walk Metropolis algorithm.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="kw">library</span>(Rcpp)</span>
<span id="cb41-2"><a href="#cb41-2"></a><span class="kw">library</span>(RcppArmadillo)</span>
<span id="cb41-3"><a href="#cb41-3"></a></span>
<span id="cb41-4"><a href="#cb41-4"></a><span class="kw">sourceCpp</span>(</span>
<span id="cb41-5"><a href="#cb41-5"></a>  <span class="dt">code =</span> <span class="st">&#39;</span></span>
<span id="cb41-6"><a href="#cb41-6"></a><span class="st">    #include&lt;Rmath.h&gt;</span></span>
<span id="cb41-7"><a href="#cb41-7"></a><span class="st">    #include&lt;RcppCommon.h&gt;</span></span>
<span id="cb41-8"><a href="#cb41-8"></a><span class="st">    #include&lt;RcppArmadillo.h&gt;</span></span>
<span id="cb41-9"><a href="#cb41-9"></a><span class="st">    </span></span>
<span id="cb41-10"><a href="#cb41-10"></a><span class="st">    // [[Rcpp::depends(RcppArmadillo)]]</span></span>
<span id="cb41-11"><a href="#cb41-11"></a><span class="st">    using namespace std;</span></span>
<span id="cb41-12"><a href="#cb41-12"></a><span class="st">    using namespace arma;</span></span>
<span id="cb41-13"><a href="#cb41-13"></a><span class="st">    </span></span>
<span id="cb41-14"><a href="#cb41-14"></a><span class="st">    // [[Rcpp::export]]</span></span>
<span id="cb41-15"><a href="#cb41-15"></a><span class="st">    extern &quot;C&quot; SEXP rw_Metropolis_cpp(</span></span>
<span id="cb41-16"><a href="#cb41-16"></a><span class="st">                    double sigma,</span></span>
<span id="cb41-17"><a href="#cb41-17"></a><span class="st">                    double x0,</span></span>
<span id="cb41-18"><a href="#cb41-18"></a><span class="st">                    int N){</span></span>
<span id="cb41-19"><a href="#cb41-19"></a><span class="st">      </span></span>
<span id="cb41-20"><a href="#cb41-20"></a><span class="st">      vec x(N, fill::zeros);</span></span>
<span id="cb41-21"><a href="#cb41-21"></a><span class="st">      x(0) = x0;</span></span>
<span id="cb41-22"><a href="#cb41-22"></a><span class="st">      vec u = randu&lt;vec&gt;(N);</span></span>
<span id="cb41-23"><a href="#cb41-23"></a><span class="st">      double k = 0.0;</span></span>
<span id="cb41-24"><a href="#cb41-24"></a><span class="st">      </span></span>
<span id="cb41-25"><a href="#cb41-25"></a><span class="st">      for (int i = 1; i &lt; N; i++){</span></span>
<span id="cb41-26"><a href="#cb41-26"></a><span class="st">        double y = ::Rf_rnorm(x(i - 1), sigma);</span></span>
<span id="cb41-27"><a href="#cb41-27"></a><span class="st">        if ( u(i) &lt;= exp(abs(x(i - 1))) / exp(abs(y)) ){</span></span>
<span id="cb41-28"><a href="#cb41-28"></a><span class="st">          x(i) = y;</span></span>
<span id="cb41-29"><a href="#cb41-29"></a><span class="st">        } else{</span></span>
<span id="cb41-30"><a href="#cb41-30"></a><span class="st">          x(i) = x(i - 1);</span></span>
<span id="cb41-31"><a href="#cb41-31"></a><span class="st">          ++k;</span></span>
<span id="cb41-32"><a href="#cb41-32"></a><span class="st">        }</span></span>
<span id="cb41-33"><a href="#cb41-33"></a><span class="st">      }</span></span>
<span id="cb41-34"><a href="#cb41-34"></a><span class="st">      double accept_rate = 1 - (k / N);</span></span>
<span id="cb41-35"><a href="#cb41-35"></a><span class="st">      </span></span>
<span id="cb41-36"><a href="#cb41-36"></a><span class="st">      return Rcpp::List::create(</span></span>
<span id="cb41-37"><a href="#cb41-37"></a><span class="st">        Rcpp::Named(&quot;x&quot;) = x,</span></span>
<span id="cb41-38"><a href="#cb41-38"></a><span class="st">        Rcpp::Named(&quot;accept.rate&quot;) = accept_rate</span></span>
<span id="cb41-39"><a href="#cb41-39"></a><span class="st">      );</span></span>
<span id="cb41-40"><a href="#cb41-40"></a><span class="st">    }</span></span>
<span id="cb41-41"><a href="#cb41-41"></a><span class="st">  &#39;</span></span>
<span id="cb41-42"><a href="#cb41-42"></a>)</span></code></pre></div>
<p>Now give a test example to compare the random numbers generated by both <code>R</code> and <code>C++</code> functions.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="kw">set.seed</span>(<span class="dv">1201</span>)</span>
<span id="cb42-2"><a href="#cb42-2"></a>N &lt;-<span class="st"> </span><span class="fl">1e4</span></span>
<span id="cb42-3"><a href="#cb42-3"></a>sigma &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb42-4"><a href="#cb42-4"></a>x0 &lt;-<span class="st"> </span><span class="dv">5</span></span>
<span id="cb42-5"><a href="#cb42-5"></a>result.r &lt;-<span class="st"> </span><span class="kw">rw.Metropolis.r</span>(sigma, x0, N)</span>
<span id="cb42-6"><a href="#cb42-6"></a>result.cpp &lt;-<span class="st"> </span><span class="kw">rw_Metropolis_cpp</span>(sigma, x0, N)</span></code></pre></div>
<p>Compare the trace plot generated by <code>R</code> function and <code>C++</code> function.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb43-2"><a href="#cb43-2"></a><span class="kw">plot</span>(result.r<span class="op">$</span>x, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">col=</span><span class="dv">2</span>, </span>
<span id="cb43-3"><a href="#cb43-3"></a>     <span class="dt">xlab=</span><span class="st">&quot;iters&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">6</span>,<span class="dv">6</span>), </span>
<span id="cb43-4"><a href="#cb43-4"></a>     <span class="dt">main=</span><span class="st">&quot;Trace plot: R&quot;</span>)</span>
<span id="cb43-5"><a href="#cb43-5"></a><span class="kw">plot</span>(result.cpp<span class="op">$</span>x, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">col=</span><span class="dv">3</span>, </span>
<span id="cb43-6"><a href="#cb43-6"></a>     <span class="dt">xlab=</span><span class="st">&quot;iters&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">6</span>,<span class="dv">6</span>), </span>
<span id="cb43-7"><a href="#cb43-7"></a>     <span class="dt">main=</span><span class="st">&quot;Trace plot: C++&quot;</span>)</span></code></pre></div>
<p>Generate a QQ plot for the data obtained from both two functions. We can see that the data correspond to the distribution we want to sample from.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb44-2"><a href="#cb44-2"></a>p &lt;-<span class="st"> </span><span class="kw">ppoints</span>(<span class="dv">200</span>)</span>
<span id="cb44-3"><a href="#cb44-3"></a>Q1 &lt;-<span class="st"> </span><span class="kw">quantile</span>(result.r<span class="op">$</span>x, p)</span>
<span id="cb44-4"><a href="#cb44-4"></a><span class="kw">qqplot</span>(Q1, result.r<span class="op">$</span>x, <span class="dt">pch=</span><span class="dv">16</span>, <span class="dt">cex=</span><span class="fl">0.4</span>, <span class="dt">main=</span><span class="st">&quot;qqplot: R&quot;</span>)</span>
<span id="cb44-5"><a href="#cb44-5"></a><span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb44-6"><a href="#cb44-6"></a>Q2 &lt;-<span class="st"> </span><span class="kw">quantile</span>(result.cpp<span class="op">$</span>x, p)</span>
<span id="cb44-7"><a href="#cb44-7"></a><span class="kw">qqplot</span>(Q2, result.cpp<span class="op">$</span>x, <span class="dt">pch=</span><span class="dv">16</span>, <span class="dt">cex=</span><span class="fl">0.4</span>, <span class="dt">main=</span><span class="st">&quot;qqplot: C++&quot;</span>)</span>
<span id="cb44-8"><a href="#cb44-8"></a><span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb44-9"><a href="#cb44-9"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code></pre></div>
<p>For <span class="math inline">\(\sigma=0.5,1,2\)</span>, compare the acceptance rate of <code>R</code> function and <code>C++</code> function. We can see that the acceptance rates are almost the same for both <code>R</code> and <code>C++</code> function.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a>sigma.list &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb45-2"><a href="#cb45-2"></a>acc.rate &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">sigma=</span>sigma.list, </span>
<span id="cb45-3"><a href="#cb45-3"></a>                       <span class="dt">accR=</span><span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">3</span>), </span>
<span id="cb45-4"><a href="#cb45-4"></a>                       <span class="dt">accCpp=</span><span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">3</span>))</span>
<span id="cb45-5"><a href="#cb45-5"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>){</span>
<span id="cb45-6"><a href="#cb45-6"></a>  acc.rate[i, <span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">rw.Metropolis.r</span>(sigma.list[i], x0, N)<span class="op">$</span>accept.rate</span>
<span id="cb45-7"><a href="#cb45-7"></a>  acc.rate[i, <span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">rw_Metropolis_cpp</span>(sigma.list[i], x0, N)<span class="op">$</span>accept.rate</span>
<span id="cb45-8"><a href="#cb45-8"></a>}</span>
<span id="cb45-9"><a href="#cb45-9"></a>acc.rate</span></code></pre></div>
<p>Compare the running time of <code>R</code> and <code>C++</code> version. We can see that the <code>C++</code> version function is about 20 times faster than <code>R</code> version function.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="kw">library</span>(microbenchmark)</span>
<span id="cb46-2"><a href="#cb46-2"></a>ts &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>(<span class="dt">rw.R=</span><span class="kw">rw.Metropolis.r</span>(sigma, x0, N),</span>
<span id="cb46-3"><a href="#cb46-3"></a>                     <span class="dt">rw.Cpp=</span><span class="kw">rw_Metropolis_cpp</span>(sigma, x0, N))</span>
<span id="cb46-4"><a href="#cb46-4"></a><span class="kw">summary</span>(ts)</span></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
